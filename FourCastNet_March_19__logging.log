2024-03-19 21:54:00,270 - root - WARNING - ------------------ Configuration ------------------
2024-03-19 21:54:00,289 - root - WARNING -  Key: log_to_wandb : True 
2024-03-19 21:54:00,289 - root - WARNING -  Key: lr : 0.0005 
2024-03-19 21:54:00,289 - root - WARNING -  Key: batch_size : 64 
2024-03-19 21:54:00,289 - root - WARNING -  Key: max_epochs : 150 
2024-03-19 21:54:00,289 - root - WARNING -  Key: scheduler : CosineAnnealingLR 
2024-03-19 21:54:00,289 - root - WARNING -  Key: in_channels : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19] 
2024-03-19 21:54:00,289 - root - WARNING -  Key: out_channels : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19] 
2024-03-19 21:54:00,289 - root - WARNING -  Key: orography : False 
2024-03-19 21:54:00,289 - root - WARNING -  Key: orography_path : /scratch/gilbreth/wwtung/FourCastNet/data/static/orography.h5 
2024-03-19 21:54:00,289 - root - WARNING -  Key: exp_dir : /scratch/gilbreth/gupt1075/ERA5_expts_gtc/ 
2024-03-19 21:54:00,290 - root - WARNING -  Key: train_data_path : /scratch/gilbreth/wwtung/FourCastNet/data/train/ 
2024-03-19 21:54:00,290 - root - WARNING -  Key: valid_data_path : /scratch/gilbreth/wwtung/FourCastNet/data/test/ 
2024-03-19 21:54:00,290 - root - WARNING -  Key: inf_data_path : /scratch/gilbreth/wwtung/FourCastNet/data/out_of_sample 
2024-03-19 21:54:00,290 - root - WARNING -  Key: time_means_path : /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/time_means.npy 
2024-03-19 21:54:00,290 - root - WARNING -  Key: global_means_path : /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/global_means.npy 
2024-03-19 21:54:00,290 - root - WARNING -  Key: global_stds_path : /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/global_stds.npy 
2024-03-19 21:54:00,290 - root - WARNING -  Key: loss : l2 
2024-03-19 21:54:00,290 - root - WARNING -  Key: num_data_workers : 8 
2024-03-19 21:54:00,290 - root - WARNING -  Key: dt : 1 
2024-03-19 21:54:00,290 - root - WARNING -  Key: n_history : 0 
2024-03-19 21:54:00,290 - root - WARNING -  Key: prediction_type : iterative 
2024-03-19 21:54:00,290 - root - WARNING -  Key: prediction_length : 8 
2024-03-19 21:54:00,290 - root - WARNING -  Key: n_initial_conditions : 10 
2024-03-19 21:54:00,290 - root - WARNING -  Key: ics_type : default 
2024-03-19 21:54:00,290 - root - WARNING -  Key: save_raw_forecasts : True 
2024-03-19 21:54:00,290 - root - WARNING -  Key: save_channel : False 
2024-03-19 21:54:00,290 - root - WARNING -  Key: masked_acc : False 
2024-03-19 21:54:00,290 - root - WARNING -  Key: maskpath : None 
2024-03-19 21:54:00,290 - root - WARNING -  Key: perturb : False 
2024-03-19 21:54:00,290 - root - WARNING -  Key: add_grid : False 
2024-03-19 21:54:00,290 - root - WARNING -  Key: N_grid_channels : 0 
2024-03-19 21:54:00,290 - root - WARNING -  Key: gridtype : sinusoidal 
2024-03-19 21:54:00,290 - root - WARNING -  Key: roll : False 
2024-03-19 21:54:00,290 - root - WARNING -  Key: num_blocks : 8 
2024-03-19 21:54:00,290 - root - WARNING -  Key: nettype : afno 
2024-03-19 21:54:00,290 - root - WARNING -  Key: patch_size : 8 
2024-03-19 21:54:00,290 - root - WARNING -  Key: width : 56 
2024-03-19 21:54:00,290 - root - WARNING -  Key: modes : 32 
2024-03-19 21:54:00,290 - root - WARNING -  Key: target : default 
2024-03-19 21:54:00,290 - root - WARNING -  Key: normalization : zscore 
2024-03-19 21:54:00,290 - root - WARNING -  Key: log_to_screen : True 
2024-03-19 21:54:00,290 - root - WARNING -  Key: save_checkpoint : True 
2024-03-19 21:54:00,290 - root - WARNING -  Key: enable_nhwc : False 
2024-03-19 21:54:00,290 - root - WARNING -  Key: optimizer_type : Adam 
2024-03-19 21:54:00,290 - root - WARNING -  Key: crop_size_x : None 
2024-03-19 21:54:00,290 - root - WARNING -  Key: crop_size_y : None 
2024-03-19 21:54:00,290 - root - WARNING -  Key: two_step_training : False 
2024-03-19 21:54:00,290 - root - WARNING -  Key: plot_animations : False 
2024-03-19 21:54:00,291 - root - WARNING -  Key: add_noise : False 
2024-03-19 21:54:00,291 - root - WARNING -  Key: noise_std : 0 
2024-03-19 21:54:00,291 - root - WARNING - ---------------------------------------------------
2024-03-19 21:54:00,442 - root - INFO - ------------------ Configuration ------------------
2024-03-19 21:54:00,443 - root - INFO - Configuration file: /scratch/gilbreth/gupt1075/FourCastNet_gil/config/AFNO.yaml
2024-03-19 21:54:00,443 - root - INFO - Configuration name: afno_backbone
2024-03-19 21:54:00,443 - root - INFO - log_to_wandb True
2024-03-19 21:54:00,443 - root - INFO - lr 0.0005
2024-03-19 21:54:00,443 - root - INFO - batch_size 64
2024-03-19 21:54:00,443 - root - INFO - max_epochs 150
2024-03-19 21:54:00,443 - root - INFO - scheduler CosineAnnealingLR
2024-03-19 21:54:00,443 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2024-03-19 21:54:00,443 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2024-03-19 21:54:00,443 - root - INFO - orography False
2024-03-19 21:54:00,443 - root - INFO - orography_path /scratch/gilbreth/wwtung/FourCastNet/data/static/orography.h5
2024-03-19 21:54:00,443 - root - INFO - exp_dir /scratch/gilbreth/gupt1075/ERA5_expts_gtc/
2024-03-19 21:54:00,443 - root - INFO - train_data_path /scratch/gilbreth/wwtung/FourCastNet/data/train/
2024-03-19 21:54:00,443 - root - INFO - valid_data_path /scratch/gilbreth/wwtung/FourCastNet/data/test/
2024-03-19 21:54:00,443 - root - INFO - inf_data_path /scratch/gilbreth/wwtung/FourCastNet/data/out_of_sample
2024-03-19 21:54:00,443 - root - INFO - time_means_path /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/time_means.npy
2024-03-19 21:54:00,443 - root - INFO - global_means_path /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/global_means.npy
2024-03-19 21:54:00,443 - root - INFO - global_stds_path /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/global_stds.npy
2024-03-19 21:54:00,443 - root - INFO - loss l2
2024-03-19 21:54:00,443 - root - INFO - num_data_workers 8
2024-03-19 21:54:00,443 - root - INFO - dt 1
2024-03-19 21:54:00,443 - root - INFO - n_history 0
2024-03-19 21:54:00,443 - root - INFO - prediction_type iterative
2024-03-19 21:54:00,443 - root - INFO - prediction_length 8
2024-03-19 21:54:00,443 - root - INFO - n_initial_conditions 10
2024-03-19 21:54:00,443 - root - INFO - ics_type default
2024-03-19 21:54:00,443 - root - INFO - save_raw_forecasts True
2024-03-19 21:54:00,443 - root - INFO - save_channel False
2024-03-19 21:54:00,443 - root - INFO - masked_acc False
2024-03-19 21:54:00,443 - root - INFO - maskpath None
2024-03-19 21:54:00,443 - root - INFO - perturb False
2024-03-19 21:54:00,443 - root - INFO - add_grid False
2024-03-19 21:54:00,443 - root - INFO - N_grid_channels 0
2024-03-19 21:54:00,443 - root - INFO - gridtype sinusoidal
2024-03-19 21:54:00,443 - root - INFO - roll False
2024-03-19 21:54:00,443 - root - INFO - num_blocks 8
2024-03-19 21:54:00,443 - root - INFO - nettype afno
2024-03-19 21:54:00,443 - root - INFO - patch_size 8
2024-03-19 21:54:00,443 - root - INFO - width 56
2024-03-19 21:54:00,443 - root - INFO - modes 32
2024-03-19 21:54:00,443 - root - INFO - target default
2024-03-19 21:54:00,443 - root - INFO - normalization zscore
2024-03-19 21:54:00,443 - root - INFO - log_to_screen True
2024-03-19 21:54:00,443 - root - INFO - save_checkpoint True
2024-03-19 21:54:00,444 - root - INFO - enable_nhwc False
2024-03-19 21:54:00,444 - root - INFO - optimizer_type Adam
2024-03-19 21:54:00,444 - root - INFO - crop_size_x None
2024-03-19 21:54:00,444 - root - INFO - crop_size_y None
2024-03-19 21:54:00,444 - root - INFO - two_step_training False
2024-03-19 21:54:00,444 - root - INFO - plot_animations False
2024-03-19 21:54:00,444 - root - INFO - add_noise False
2024-03-19 21:54:00,444 - root - INFO - noise_std 0
2024-03-19 21:54:00,444 - root - INFO - fld z500
2024-03-19 21:54:00,444 - root - INFO - world_size 1
2024-03-19 21:54:00,444 - root - INFO - interp 0
2024-03-19 21:54:00,444 - root - INFO - use_daily_climatology False
2024-03-19 21:54:00,444 - root - INFO - global_batch_size 64
2024-03-19 21:54:00,444 - root - INFO - idxes {'u10': 0, 'z500': 14, '2m_temperature': 2, 'v10': 1, 't850': 5}
2024-03-19 21:54:00,444 - root - INFO - DECORRELATION_TIME 36
2024-03-19 21:54:00,444 - root - INFO - experiment_dir /scratch/gilbreth/gupt1075/ERA5_expts_march_19/afno_backbone/222
2024-03-19 21:54:00,444 - root - INFO - best_checkpoint_path /scratch/gilbreth/wwtung/FourCastNet/model_weights/FCN_weights_v0/backbone.ckpt
2024-03-19 21:54:00,444 - root - INFO - resuming False
2024-03-19 21:54:00,444 - root - INFO - local_rank 0
2024-03-19 21:54:00,444 - root - INFO - ---------------------------------------------------
2024-03-19 21:54:00,444 - root - WARNING -  
 ICS for default: [  0  36  72 108 144 180 216 252 288 324] num_samples 1328  prediction_lnegth: 8   
2024-03-19 21:54:00,446 - root - WARNING - Getting file stats from /scratch/gilbreth/wwtung/FourCastNet/data/out_of_sample/2018.h5
2024-03-19 21:54:00,447 - root - WARNING -  n_years: 1  
 n_samples_per_yeaer: 1460 
 dt: 1  n_history: 0 
2024-03-19 21:54:00,447 - root - WARNING - Number of samples per year: 1460
2024-03-19 21:54:00,447 - root - WARNING - Found data at path /scratch/gilbreth/wwtung/FourCastNet/data/out_of_sample. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2024-03-19 21:54:00,447 - root - WARNING - Delta t: 6 hours
2024-03-19 21:54:00,447 - root - WARNING - Including 0 hours of past history in training at a frequency of 6 hours
2024-03-19 21:54:00,447 - root - INFO - Loading trained model checkpoint from /scratch/gilbreth/wwtung/FourCastNet/model_weights/FCN_weights_v0/backbone.ckpt
2024-03-19 21:54:00,449 - root - INFO -  in_channels  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19] 20   >>   out_channels [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19] 20  params.global_means_path /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/global_means.npy params.global_stds_path /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/global_stds.npy  
2024-03-19 21:54:02,272 - root - INFO -  in_channels 20   out_channels 20  params.global_means_path /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/global_means.npy params.global_stds_path /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/global_stds.npy  
2024-03-19 21:54:02,273 - root - INFO -  Loading validation data from ['/scratch/gilbreth/wwtung/FourCastNet/data/out_of_sample/2018.h5']
2024-03-19 21:54:02,273 - root - WARNING -  valid_year 2018   
2024-03-19 21:54:02,274 - root - WARNING - Initial condition 1 of 10 with corresponidng time  =  01_January_00_2018 and valid_year 2018
2024-03-19 21:54:02,980 - root - INFO - Begin autoregressive inference
2024-03-19 21:54:03,710 - root - INFO - Predicted timestep 0 of 8. z500 RMS Error: 0.0, ACC: 1.0
2024-03-19 21:54:04,961 - root - INFO - Predicted timestep 1 of 8. z500 RMS Error: 34.425804138183594, ACC: 0.9996493458747864
2024-03-19 21:54:05,112 - root - INFO - Predicted timestep 2 of 8. z500 RMS Error: 48.357078552246094, ACC: 0.9993206262588501
2024-03-19 21:54:05,265 - root - INFO - Predicted timestep 3 of 8. z500 RMS Error: 63.70835494995117, ACC: 0.9988381862640381
2024-03-19 21:54:05,417 - root - INFO - Predicted timestep 4 of 8. z500 RMS Error: 81.07498931884766, ACC: 0.9981367588043213
2024-03-19 21:54:05,569 - root - INFO - Predicted timestep 5 of 8. z500 RMS Error: 92.77654266357422, ACC: 0.9976038336753845
2024-03-19 21:54:05,722 - root - INFO - Predicted timestep 6 of 8. z500 RMS Error: 109.06070709228516, ACC: 0.9967321753501892
2024-03-19 21:54:05,874 - root - INFO - Predicted timestep 7 of 8. z500 RMS Error: 122.5030288696289, ACC: 0.9959385395050049
2024-03-19 21:54:06,915 - root - WARNING -  saved real and predicted with shape (1, 8, 20, 720, 1440) (1, 8, 20, 720, 1440) with np_save 01_January_00_2018 
2024-03-19 21:54:06,915 - root - WARNING - Initial condition 2 of 10 with corresponidng time  =  10_January_00_2018 and valid_year 2018
2024-03-19 21:54:07,612 - root - INFO - Begin autoregressive inference
2024-03-19 21:54:07,763 - root - INFO - Predicted timestep 0 of 8. z500 RMS Error: 0.0, ACC: 1.0
2024-03-19 21:54:07,915 - root - INFO - Predicted timestep 1 of 8. z500 RMS Error: 37.18465042114258, ACC: 0.999663233757019
2024-03-19 21:54:08,067 - root - INFO - Predicted timestep 2 of 8. z500 RMS Error: 52.85227966308594, ACC: 0.9993199706077576
2024-03-19 21:54:08,218 - root - INFO - Predicted timestep 3 of 8. z500 RMS Error: 71.33325958251953, ACC: 0.998769223690033
2024-03-19 21:54:08,370 - root - INFO - Predicted timestep 4 of 8. z500 RMS Error: 89.89252471923828, ACC: 0.9980303645133972
2024-03-19 21:54:08,522 - root - INFO - Predicted timestep 5 of 8. z500 RMS Error: 105.95235443115234, ACC: 0.997300922870636
2024-03-19 21:54:08,674 - root - INFO - Predicted timestep 6 of 8. z500 RMS Error: 126.47808837890625, ACC: 0.9961051344871521
2024-03-19 21:54:08,826 - root - INFO - Predicted timestep 7 of 8. z500 RMS Error: 138.492919921875, ACC: 0.9953263998031616
2024-03-19 21:54:10,023 - root - WARNING -  saved real and predicted with shape (1, 8, 20, 720, 1440) (1, 8, 20, 720, 1440) with np_save 10_January_00_2018 
2024-03-19 21:54:10,024 - root - WARNING - Initial condition 3 of 10 with corresponidng time  =  19_January_00_2018 and valid_year 2018
2024-03-19 21:54:10,697 - root - INFO - Begin autoregressive inference
2024-03-19 21:54:10,848 - root - INFO - Predicted timestep 0 of 8. z500 RMS Error: 0.0, ACC: 1.0
2024-03-19 21:54:11,001 - root - INFO - Predicted timestep 1 of 8. z500 RMS Error: 35.458255767822266, ACC: 0.9996299147605896
2024-03-19 21:54:11,153 - root - INFO - Predicted timestep 2 of 8. z500 RMS Error: 52.08525848388672, ACC: 0.9991850852966309
2024-03-19 21:54:11,305 - root - INFO - Predicted timestep 3 of 8. z500 RMS Error: 64.06492614746094, ACC: 0.9987519979476929
2024-03-19 21:54:11,458 - root - INFO - Predicted timestep 4 of 8. z500 RMS Error: 82.7522201538086, ACC: 0.9979271292686462
2024-03-19 21:54:11,610 - root - INFO - Predicted timestep 5 of 8. z500 RMS Error: 97.86416625976562, ACC: 0.9970927238464355
2024-03-19 21:54:11,763 - root - INFO - Predicted timestep 6 of 8. z500 RMS Error: 116.19584655761719, ACC: 0.9959009289741516
2024-03-19 21:54:11,915 - root - INFO - Predicted timestep 7 of 8. z500 RMS Error: 132.14974975585938, ACC: 0.9947429299354553
2024-03-19 21:54:13,051 - root - WARNING -  saved real and predicted with shape (1, 8, 20, 720, 1440) (1, 8, 20, 720, 1440) with np_save 19_January_00_2018 
2024-03-19 21:54:13,051 - root - WARNING - Initial condition 4 of 10 with corresponidng time  =  28_January_00_2018 and valid_year 2018
2024-03-19 21:54:13,769 - root - INFO - Begin autoregressive inference
2024-03-19 21:54:13,920 - root - INFO - Predicted timestep 0 of 8. z500 RMS Error: 0.0, ACC: 1.0
2024-03-19 21:54:14,072 - root - INFO - Predicted timestep 1 of 8. z500 RMS Error: 40.4893913269043, ACC: 0.9995498657226562
2024-03-19 21:54:14,224 - root - INFO - Predicted timestep 2 of 8. z500 RMS Error: 52.22865295410156, ACC: 0.9992458820343018
2024-03-19 21:54:14,376 - root - INFO - Predicted timestep 3 of 8. z500 RMS Error: 62.845741271972656, ACC: 0.998900294303894
2024-03-19 21:54:14,529 - root - INFO - Predicted timestep 4 of 8. z500 RMS Error: 82.02289581298828, ACC: 0.9981224536895752
2024-03-19 21:54:14,681 - root - INFO - Predicted timestep 5 of 8. z500 RMS Error: 100.29154205322266, ACC: 0.9971843361854553
2024-03-19 21:54:14,834 - root - INFO - Predicted timestep 6 of 8. z500 RMS Error: 120.46273040771484, ACC: 0.9959070682525635
2024-03-19 21:54:14,987 - root - INFO - Predicted timestep 7 of 8. z500 RMS Error: 143.21377563476562, ACC: 0.9942840933799744
2024-03-19 21:54:16,122 - root - WARNING -  saved real and predicted with shape (1, 8, 20, 720, 1440) (1, 8, 20, 720, 1440) with np_save 28_January_00_2018 
2024-03-19 21:54:16,122 - root - WARNING - Initial condition 5 of 10 with corresponidng time  =  06_February_00_2018 and valid_year 2018
2024-03-19 21:54:16,807 - root - INFO - Begin autoregressive inference
2024-03-19 21:54:16,958 - root - INFO - Predicted timestep 0 of 8. z500 RMS Error: 0.0, ACC: 1.0
2024-03-19 21:54:17,111 - root - INFO - Predicted timestep 1 of 8. z500 RMS Error: 40.481136322021484, ACC: 0.9996451139450073
2024-03-19 21:54:17,262 - root - INFO - Predicted timestep 2 of 8. z500 RMS Error: 57.44785690307617, ACC: 0.9992781281471252
2024-03-19 21:54:17,414 - root - INFO - Predicted timestep 3 of 8. z500 RMS Error: 72.76214599609375, ACC: 0.9988397359848022
2024-03-19 21:54:17,567 - root - INFO - Predicted timestep 4 of 8. z500 RMS Error: 91.57139587402344, ACC: 0.9981630444526672
2024-03-19 21:54:17,719 - root - INFO - Predicted timestep 5 of 8. z500 RMS Error: 108.3152847290039, ACC: 0.997439980506897
2024-03-19 21:54:17,872 - root - INFO - Predicted timestep 6 of 8. z500 RMS Error: 128.69366455078125, ACC: 0.996364176273346
2024-03-19 21:54:18,024 - root - INFO - Predicted timestep 7 of 8. z500 RMS Error: 147.7533416748047, ACC: 0.9952389597892761
2024-03-19 21:54:19,182 - root - WARNING -  saved real and predicted with shape (1, 8, 20, 720, 1440) (1, 8, 20, 720, 1440) with np_save 06_February_00_2018 
2024-03-19 21:54:19,182 - root - WARNING - Initial condition 6 of 10 with corresponidng time  =  15_February_00_2018 and valid_year 2018
2024-03-19 21:54:19,854 - root - INFO - Begin autoregressive inference
2024-03-19 21:54:20,005 - root - INFO - Predicted timestep 0 of 8. z500 RMS Error: 0.0, ACC: 1.0
2024-03-19 21:54:20,158 - root - INFO - Predicted timestep 1 of 8. z500 RMS Error: 39.718048095703125, ACC: 0.9996256232261658
2024-03-19 21:54:20,310 - root - INFO - Predicted timestep 2 of 8. z500 RMS Error: 57.09104919433594, ACC: 0.9992268085479736
2024-03-19 21:54:20,463 - root - INFO - Predicted timestep 3 of 8. z500 RMS Error: 70.63634490966797, ACC: 0.9987655878067017
2024-03-19 21:54:20,616 - root - INFO - Predicted timestep 4 of 8. z500 RMS Error: 87.80720520019531, ACC: 0.998060405254364
2024-03-19 21:54:20,768 - root - INFO - Predicted timestep 5 of 8. z500 RMS Error: 105.1732406616211, ACC: 0.9971781373023987
2024-03-19 21:54:20,921 - root - INFO - Predicted timestep 6 of 8. z500 RMS Error: 122.47148895263672, ACC: 0.996116578578949
2024-03-19 21:54:21,074 - root - INFO - Predicted timestep 7 of 8. z500 RMS Error: 136.8862762451172, ACC: 0.9951531291007996
2024-03-19 21:54:22,222 - root - WARNING -  saved real and predicted with shape (1, 8, 20, 720, 1440) (1, 8, 20, 720, 1440) with np_save 15_February_00_2018 
2024-03-19 21:54:22,222 - root - WARNING - Initial condition 7 of 10 with corresponidng time  =  24_February_00_2018 and valid_year 2018
2024-03-19 21:54:22,895 - root - INFO - Begin autoregressive inference
2024-03-19 21:54:23,047 - root - INFO - Predicted timestep 0 of 8. z500 RMS Error: 0.0, ACC: 1.0
2024-03-19 21:54:23,199 - root - INFO - Predicted timestep 1 of 8. z500 RMS Error: 39.98298263549805, ACC: 0.9996182322502136
2024-03-19 21:54:23,352 - root - INFO - Predicted timestep 2 of 8. z500 RMS Error: 58.585636138916016, ACC: 0.999182403087616
2024-03-19 21:54:23,505 - root - INFO - Predicted timestep 3 of 8. z500 RMS Error: 70.41835021972656, ACC: 0.9988466501235962
2024-03-19 21:54:23,657 - root - INFO - Predicted timestep 4 of 8. z500 RMS Error: 87.94905090332031, ACC: 0.9981626868247986
2024-03-19 21:54:23,810 - root - INFO - Predicted timestep 5 of 8. z500 RMS Error: 108.07262420654297, ACC: 0.9971847534179688
2024-03-19 21:54:23,961 - root - INFO - Predicted timestep 6 of 8. z500 RMS Error: 133.9787139892578, ACC: 0.9956145882606506
2024-03-19 21:54:24,114 - root - INFO - Predicted timestep 7 of 8. z500 RMS Error: 160.52780151367188, ACC: 0.9937047958374023
2024-03-19 21:54:25,224 - root - WARNING -  saved real and predicted with shape (1, 8, 20, 720, 1440) (1, 8, 20, 720, 1440) with np_save 24_February_00_2018 
2024-03-19 21:54:25,224 - root - WARNING - Initial condition 8 of 10 with corresponidng time  =  05_March_00_2018 and valid_year 2018
2024-03-19 21:54:25,908 - root - INFO - Begin autoregressive inference
2024-03-19 21:54:26,060 - root - INFO - Predicted timestep 0 of 8. z500 RMS Error: 0.0, ACC: 1.0
2024-03-19 21:54:26,213 - root - INFO - Predicted timestep 1 of 8. z500 RMS Error: 34.423553466796875, ACC: 0.999656617641449
2024-03-19 21:54:26,367 - root - INFO - Predicted timestep 2 of 8. z500 RMS Error: 49.0748405456543, ACC: 0.9993000626564026
2024-03-19 21:54:26,520 - root - INFO - Predicted timestep 3 of 8. z500 RMS Error: 57.91379165649414, ACC: 0.9989942312240601
2024-03-19 21:54:26,672 - root - INFO - Predicted timestep 4 of 8. z500 RMS Error: 78.26386260986328, ACC: 0.9981685280799866
2024-03-19 21:54:26,825 - root - INFO - Predicted timestep 5 of 8. z500 RMS Error: 89.12337493896484, ACC: 0.9976483583450317
2024-03-19 21:54:26,978 - root - INFO - Predicted timestep 6 of 8. z500 RMS Error: 108.42176055908203, ACC: 0.9964566826820374
2024-03-19 21:54:27,131 - root - INFO - Predicted timestep 7 of 8. z500 RMS Error: 122.80377960205078, ACC: 0.9954012036323547
2024-03-19 21:54:28,200 - root - WARNING -  saved real and predicted with shape (1, 8, 20, 720, 1440) (1, 8, 20, 720, 1440) with np_save 05_March_00_2018 
2024-03-19 21:54:28,200 - root - WARNING - Initial condition 9 of 10 with corresponidng time  =  14_March_00_2018 and valid_year 2018
2024-03-19 21:54:28,873 - root - INFO - Begin autoregressive inference
2024-03-19 21:54:29,024 - root - INFO - Predicted timestep 0 of 8. z500 RMS Error: 0.0, ACC: 1.0
2024-03-19 21:54:29,176 - root - INFO - Predicted timestep 1 of 8. z500 RMS Error: 34.316184997558594, ACC: 0.9996668696403503
2024-03-19 21:54:29,329 - root - INFO - Predicted timestep 2 of 8. z500 RMS Error: 52.199031829833984, ACC: 0.9992451071739197
2024-03-19 21:54:29,482 - root - INFO - Predicted timestep 3 of 8. z500 RMS Error: 67.4875717163086, ACC: 0.9987603425979614
2024-03-19 21:54:29,635 - root - INFO - Predicted timestep 4 of 8. z500 RMS Error: 91.89934539794922, ACC: 0.9977535009384155
2024-03-19 21:54:29,788 - root - INFO - Predicted timestep 5 of 8. z500 RMS Error: 112.46349334716797, ACC: 0.9967042803764343
2024-03-19 21:54:29,942 - root - INFO - Predicted timestep 6 of 8. z500 RMS Error: 135.7175750732422, ACC: 0.9952130913734436
2024-03-19 21:54:30,095 - root - INFO - Predicted timestep 7 of 8. z500 RMS Error: 158.6426239013672, ACC: 0.9934440851211548
2024-03-19 21:54:31,211 - root - WARNING -  saved real and predicted with shape (1, 8, 20, 720, 1440) (1, 8, 20, 720, 1440) with np_save 14_March_00_2018 
2024-03-19 21:54:31,211 - root - WARNING - Initial condition 10 of 10 with corresponidng time  =  23_March_00_2018 and valid_year 2018
2024-03-19 21:54:31,884 - root - INFO - Begin autoregressive inference
2024-03-19 21:54:32,035 - root - INFO - Predicted timestep 0 of 8. z500 RMS Error: 0.0, ACC: 1.0
2024-03-19 21:54:32,187 - root - INFO - Predicted timestep 1 of 8. z500 RMS Error: 36.96066665649414, ACC: 0.9996141195297241
2024-03-19 21:54:32,341 - root - INFO - Predicted timestep 2 of 8. z500 RMS Error: 53.25741195678711, ACC: 0.9991965293884277
2024-03-19 21:54:32,493 - root - INFO - Predicted timestep 3 of 8. z500 RMS Error: 67.00923919677734, ACC: 0.9987416863441467
2024-03-19 21:54:32,646 - root - INFO - Predicted timestep 4 of 8. z500 RMS Error: 87.139404296875, ACC: 0.9979001879692078
2024-03-19 21:54:32,799 - root - INFO - Predicted timestep 5 of 8. z500 RMS Error: 101.99374389648438, ACC: 0.9971166253089905
2024-03-19 21:54:32,952 - root - INFO - Predicted timestep 6 of 8. z500 RMS Error: 119.45429992675781, ACC: 0.9959083199501038
2024-03-19 21:54:33,105 - root - INFO - Predicted timestep 7 of 8. z500 RMS Error: 136.1692352294922, ACC: 0.994572103023529
2024-03-19 21:54:34,209 - root - WARNING -  saved real and predicted with shape (1, 8, 20, 720, 1440) (1, 8, 20, 720, 1440) with np_save 23_March_00_2018 
2024-03-19 21:54:34,210 - root - INFO - Shapes: seq_real (1, 8, 20, 720, 1440), seq_pred (1, 8, 20, 720, 1440), valid_loss (10, 8, 20), valid_loss_coarse (10, 8, 20), acc (10, 8, 20), acc_coarse (10, 8, 20), acc_coarse_unweighted (10, 8, 20), acc_unweighted (10, 8, 20), acc_land (10, 8, 20), acc_sea (10, 8, 20)
2024-03-19 21:54:34,210 - root - INFO - Saving files at /scratch/gilbreth/gupt1075/ERA5_expts_march_19/afno_backbone/222/autoregressive_predictions_z500.h5
2024-03-19 21:54:34,210 - root - WARNING -  >>> ONLY_FLD (10, 8)  (10, 8) 
2024-03-19 21:54:47,190 - root - WARNING - ------------------ Configuration ------------------
2024-03-19 21:54:47,209 - root - WARNING -  Key: log_to_wandb : True 
2024-03-19 21:54:47,209 - root - WARNING -  Key: lr : 0.0005 
2024-03-19 21:54:47,209 - root - WARNING -  Key: batch_size : 64 
2024-03-19 21:54:47,209 - root - WARNING -  Key: max_epochs : 150 
2024-03-19 21:54:47,209 - root - WARNING -  Key: scheduler : CosineAnnealingLR 
2024-03-19 21:54:47,209 - root - WARNING -  Key: in_channels : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19] 
2024-03-19 21:54:47,209 - root - WARNING -  Key: out_channels : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19] 
2024-03-19 21:54:47,209 - root - WARNING -  Key: orography : False 
2024-03-19 21:54:47,209 - root - WARNING -  Key: orography_path : /scratch/gilbreth/wwtung/FourCastNet/data/static/orography.h5 
2024-03-19 21:54:47,209 - root - WARNING -  Key: exp_dir : /scratch/gilbreth/gupt1075/ERA5_expts_gtc/ 
2024-03-19 21:54:47,209 - root - WARNING -  Key: train_data_path : /scratch/gilbreth/wwtung/FourCastNet/data/train/ 
2024-03-19 21:54:47,209 - root - WARNING -  Key: valid_data_path : /scratch/gilbreth/wwtung/FourCastNet/data/test/ 
2024-03-19 21:54:47,209 - root - WARNING -  Key: inf_data_path : /scratch/gilbreth/wwtung/FourCastNet/data/out_of_sample 
2024-03-19 21:54:47,209 - root - WARNING -  Key: time_means_path : /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/time_means.npy 
2024-03-19 21:54:47,209 - root - WARNING -  Key: global_means_path : /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/global_means.npy 
2024-03-19 21:54:47,209 - root - WARNING -  Key: global_stds_path : /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/global_stds.npy 
2024-03-19 21:54:47,209 - root - WARNING -  Key: loss : l2 
2024-03-19 21:54:47,209 - root - WARNING -  Key: num_data_workers : 8 
2024-03-19 21:54:47,209 - root - WARNING -  Key: dt : 1 
2024-03-19 21:54:47,209 - root - WARNING -  Key: n_history : 0 
2024-03-19 21:54:47,209 - root - WARNING -  Key: prediction_type : iterative 
2024-03-19 21:54:47,209 - root - WARNING -  Key: prediction_length : 8 
2024-03-19 21:54:47,209 - root - WARNING -  Key: n_initial_conditions : 10 
2024-03-19 21:54:47,209 - root - WARNING -  Key: ics_type : default 
2024-03-19 21:54:47,209 - root - WARNING -  Key: save_raw_forecasts : True 
2024-03-19 21:54:47,209 - root - WARNING -  Key: save_channel : False 
2024-03-19 21:54:47,209 - root - WARNING -  Key: masked_acc : False 
2024-03-19 21:54:47,209 - root - WARNING -  Key: maskpath : None 
2024-03-19 21:54:47,209 - root - WARNING -  Key: perturb : False 
2024-03-19 21:54:47,209 - root - WARNING -  Key: add_grid : False 
2024-03-19 21:54:47,209 - root - WARNING -  Key: N_grid_channels : 0 
2024-03-19 21:54:47,209 - root - WARNING -  Key: gridtype : sinusoidal 
2024-03-19 21:54:47,210 - root - WARNING -  Key: roll : False 
2024-03-19 21:54:47,210 - root - WARNING -  Key: num_blocks : 8 
2024-03-19 21:54:47,210 - root - WARNING -  Key: nettype : afno 
2024-03-19 21:54:47,210 - root - WARNING -  Key: patch_size : 8 
2024-03-19 21:54:47,210 - root - WARNING -  Key: width : 56 
2024-03-19 21:54:47,210 - root - WARNING -  Key: modes : 32 
2024-03-19 21:54:47,210 - root - WARNING -  Key: target : default 
2024-03-19 21:54:47,210 - root - WARNING -  Key: normalization : zscore 
2024-03-19 21:54:47,210 - root - WARNING -  Key: log_to_screen : True 
2024-03-19 21:54:47,210 - root - WARNING -  Key: save_checkpoint : True 
2024-03-19 21:54:47,210 - root - WARNING -  Key: enable_nhwc : False 
2024-03-19 21:54:47,210 - root - WARNING -  Key: optimizer_type : Adam 
2024-03-19 21:54:47,210 - root - WARNING -  Key: crop_size_x : None 
2024-03-19 21:54:47,210 - root - WARNING -  Key: crop_size_y : None 
2024-03-19 21:54:47,210 - root - WARNING -  Key: two_step_training : False 
2024-03-19 21:54:47,210 - root - WARNING -  Key: plot_animations : False 
2024-03-19 21:54:47,210 - root - WARNING -  Key: add_noise : False 
2024-03-19 21:54:47,210 - root - WARNING -  Key: noise_std : 0 
2024-03-19 21:54:47,210 - root - WARNING - ---------------------------------------------------
2024-03-19 21:54:47,361 - root - INFO - ------------------ Configuration ------------------
2024-03-19 21:54:47,361 - root - INFO - Configuration file: /scratch/gilbreth/gupt1075/FourCastNet_gil/config/AFNO.yaml
2024-03-19 21:54:47,361 - root - INFO - Configuration name: afno_backbone
2024-03-19 21:54:47,361 - root - INFO - log_to_wandb True
2024-03-19 21:54:47,361 - root - INFO - lr 0.0005
2024-03-19 21:54:47,361 - root - INFO - batch_size 64
2024-03-19 21:54:47,361 - root - INFO - max_epochs 150
2024-03-19 21:54:47,361 - root - INFO - scheduler CosineAnnealingLR
2024-03-19 21:54:47,361 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2024-03-19 21:54:47,361 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2024-03-19 21:54:47,361 - root - INFO - orography False
2024-03-19 21:54:47,361 - root - INFO - orography_path /scratch/gilbreth/wwtung/FourCastNet/data/static/orography.h5
2024-03-19 21:54:47,361 - root - INFO - exp_dir /scratch/gilbreth/gupt1075/ERA5_expts_gtc/
2024-03-19 21:54:47,361 - root - INFO - train_data_path /scratch/gilbreth/wwtung/FourCastNet/data/train/
2024-03-19 21:54:47,361 - root - INFO - valid_data_path /scratch/gilbreth/wwtung/FourCastNet/data/test/
2024-03-19 21:54:47,361 - root - INFO - inf_data_path /scratch/gilbreth/wwtung/FourCastNet/data/out_of_sample
2024-03-19 21:54:47,361 - root - INFO - time_means_path /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/time_means.npy
2024-03-19 21:54:47,361 - root - INFO - global_means_path /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/global_means.npy
2024-03-19 21:54:47,361 - root - INFO - global_stds_path /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/global_stds.npy
2024-03-19 21:54:47,361 - root - INFO - loss l2
2024-03-19 21:54:47,362 - root - INFO - num_data_workers 8
2024-03-19 21:54:47,362 - root - INFO - dt 1
2024-03-19 21:54:47,362 - root - INFO - n_history 0
2024-03-19 21:54:47,362 - root - INFO - prediction_type iterative
2024-03-19 21:54:47,362 - root - INFO - prediction_length 8
2024-03-19 21:54:47,362 - root - INFO - n_initial_conditions 10
2024-03-19 21:54:47,362 - root - INFO - ics_type default
2024-03-19 21:54:47,362 - root - INFO - save_raw_forecasts True
2024-03-19 21:54:47,362 - root - INFO - save_channel False
2024-03-19 21:54:47,362 - root - INFO - masked_acc False
2024-03-19 21:54:47,362 - root - INFO - maskpath None
2024-03-19 21:54:47,362 - root - INFO - perturb False
2024-03-19 21:54:47,362 - root - INFO - add_grid False
2024-03-19 21:54:47,362 - root - INFO - N_grid_channels 0
2024-03-19 21:54:47,362 - root - INFO - gridtype sinusoidal
2024-03-19 21:54:47,362 - root - INFO - roll False
2024-03-19 21:54:47,362 - root - INFO - num_blocks 8
2024-03-19 21:54:47,362 - root - INFO - nettype afno
2024-03-19 21:54:47,362 - root - INFO - patch_size 8
2024-03-19 21:54:47,362 - root - INFO - width 56
2024-03-19 21:54:47,362 - root - INFO - modes 32
2024-03-19 21:54:47,362 - root - INFO - target default
2024-03-19 21:54:47,362 - root - INFO - normalization zscore
2024-03-19 21:54:47,362 - root - INFO - log_to_screen True
2024-03-19 21:54:47,362 - root - INFO - save_checkpoint True
2024-03-19 21:54:47,362 - root - INFO - enable_nhwc False
2024-03-19 21:54:47,362 - root - INFO - optimizer_type Adam
2024-03-19 21:54:47,362 - root - INFO - crop_size_x None
2024-03-19 21:54:47,362 - root - INFO - crop_size_y None
2024-03-19 21:54:47,362 - root - INFO - two_step_training False
2024-03-19 21:54:47,362 - root - INFO - plot_animations False
2024-03-19 21:54:47,362 - root - INFO - add_noise False
2024-03-19 21:54:47,362 - root - INFO - noise_std 0
2024-03-19 21:54:47,362 - root - INFO - fld z500
2024-03-19 21:54:47,362 - root - INFO - world_size 1
2024-03-19 21:54:47,362 - root - INFO - interp 0
2024-03-19 21:54:47,362 - root - INFO - use_daily_climatology False
2024-03-19 21:54:47,362 - root - INFO - global_batch_size 64
2024-03-19 21:54:47,362 - root - INFO - idxes {'u10': 0, 'z500': 14, '2m_temperature': 2, 'v10': 1, 't850': 5}
2024-03-19 21:54:47,362 - root - INFO - DECORRELATION_TIME 36
2024-03-19 21:54:47,362 - root - INFO - experiment_dir /scratch/gilbreth/gupt1075/ERA5_expts_march_19/afno_backbone/222
2024-03-19 21:54:47,362 - root - INFO - best_checkpoint_path /scratch/gilbreth/wwtung/FourCastNet/model_weights/FCN_weights_v0/backbone.ckpt
2024-03-19 21:54:47,362 - root - INFO - resuming False
2024-03-19 21:54:47,362 - root - INFO - local_rank 0
2024-03-19 21:54:47,362 - root - INFO - ---------------------------------------------------
2024-03-19 21:54:47,363 - root - WARNING -  
 ICS for default: [  0  36  72 108 144 180 216 252 288 324] num_samples 1328  prediction_lnegth: 8   
2024-03-19 21:54:47,364 - root - WARNING - Getting file stats from /scratch/gilbreth/wwtung/FourCastNet/data/out_of_sample/2018.h5
2024-03-19 21:54:47,365 - root - WARNING -  n_years: 1  
 n_samples_per_yeaer: 1460 
 dt: 1  n_history: 0 
2024-03-19 21:54:47,365 - root - WARNING - Number of samples per year: 1460
2024-03-19 21:54:47,365 - root - WARNING - Found data at path /scratch/gilbreth/wwtung/FourCastNet/data/out_of_sample. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2024-03-19 21:54:47,365 - root - WARNING - Delta t: 6 hours
2024-03-19 21:54:47,365 - root - WARNING - Including 0 hours of past history in training at a frequency of 6 hours
2024-03-19 21:54:47,366 - root - INFO - Loading trained model checkpoint from /scratch/gilbreth/wwtung/FourCastNet/model_weights/FCN_weights_v0/backbone.ckpt
2024-03-19 21:54:47,367 - root - INFO -  in_channels  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19] 20   >>   out_channels [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19] 20  params.global_means_path /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/global_means.npy params.global_stds_path /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/global_stds.npy  
2024-03-19 21:54:48,996 - root - INFO -  in_channels 20   out_channels 20  params.global_means_path /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/global_means.npy params.global_stds_path /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/global_stds.npy  
2024-03-19 21:54:48,997 - root - INFO -  Loading validation data from ['/scratch/gilbreth/wwtung/FourCastNet/data/out_of_sample/2018.h5']
2024-03-19 21:54:48,997 - root - WARNING -  valid_year 2018   
2024-03-19 21:54:48,999 - root - WARNING - Initial condition 1 of 10 with corresponidng time  =  01_January_00_2018 and valid_year 2018
2024-03-19 21:54:49,708 - root - INFO - Begin autoregressive inference
2024-03-19 21:54:50,465 - root - INFO - Predicted timestep 0 of 8. z500 RMS Error: 0.0, ACC: 1.0
2024-03-19 21:54:51,751 - root - INFO - Predicted timestep 1 of 8. z500 RMS Error: 34.425804138183594, ACC: 0.9996493458747864
2024-03-19 21:54:51,902 - root - INFO - Predicted timestep 2 of 8. z500 RMS Error: 48.357078552246094, ACC: 0.9993206262588501
2024-03-19 21:54:52,055 - root - INFO - Predicted timestep 3 of 8. z500 RMS Error: 63.70835494995117, ACC: 0.9988381862640381
2024-03-19 21:54:52,208 - root - INFO - Predicted timestep 4 of 8. z500 RMS Error: 81.07498931884766, ACC: 0.9981367588043213
2024-03-19 21:54:52,359 - root - INFO - Predicted timestep 5 of 8. z500 RMS Error: 92.77654266357422, ACC: 0.9976038336753845
2024-03-19 21:54:52,511 - root - INFO - Predicted timestep 6 of 8. z500 RMS Error: 109.06070709228516, ACC: 0.9967321753501892
2024-03-19 21:54:52,663 - root - INFO - Predicted timestep 7 of 8. z500 RMS Error: 122.5030288696289, ACC: 0.9959385395050049
2024-03-19 21:54:53,604 - root - WARNING -  saved real and predicted with shape (1, 8, 20, 720, 1440) (1, 8, 20, 720, 1440) with np_save 01_January_00_2018 
2024-03-19 21:54:53,605 - root - WARNING - Initial condition 2 of 10 with corresponidng time  =  10_January_00_2018 and valid_year 2018
2024-03-19 21:54:54,275 - root - INFO - Begin autoregressive inference
2024-03-19 21:54:54,427 - root - INFO - Predicted timestep 0 of 8. z500 RMS Error: 0.0, ACC: 1.0
2024-03-19 21:54:54,579 - root - INFO - Predicted timestep 1 of 8. z500 RMS Error: 37.18465042114258, ACC: 0.999663233757019
2024-03-19 21:54:54,734 - root - INFO - Predicted timestep 2 of 8. z500 RMS Error: 52.85227966308594, ACC: 0.9993199706077576
2024-03-19 21:54:54,886 - root - INFO - Predicted timestep 3 of 8. z500 RMS Error: 71.33325958251953, ACC: 0.998769223690033
2024-03-19 21:54:55,039 - root - INFO - Predicted timestep 4 of 8. z500 RMS Error: 89.89252471923828, ACC: 0.9980303645133972
2024-03-19 21:54:55,191 - root - INFO - Predicted timestep 5 of 8. z500 RMS Error: 105.95235443115234, ACC: 0.997300922870636
2024-03-19 21:54:55,344 - root - INFO - Predicted timestep 6 of 8. z500 RMS Error: 126.47808837890625, ACC: 0.9961051344871521
2024-03-19 21:54:55,495 - root - INFO - Predicted timestep 7 of 8. z500 RMS Error: 138.492919921875, ACC: 0.9953263998031616
2024-03-19 21:54:56,715 - root - WARNING -  saved real and predicted with shape (1, 8, 20, 720, 1440) (1, 8, 20, 720, 1440) with np_save 10_January_00_2018 
2024-03-19 21:54:56,715 - root - WARNING - Initial condition 3 of 10 with corresponidng time  =  19_January_00_2018 and valid_year 2018
2024-03-19 21:54:57,403 - root - INFO - Begin autoregressive inference
2024-03-19 21:54:57,555 - root - INFO - Predicted timestep 0 of 8. z500 RMS Error: 0.0, ACC: 1.0
2024-03-19 21:54:57,707 - root - INFO - Predicted timestep 1 of 8. z500 RMS Error: 35.458255767822266, ACC: 0.9996299147605896
2024-03-19 21:54:57,860 - root - INFO - Predicted timestep 2 of 8. z500 RMS Error: 52.08525848388672, ACC: 0.9991850852966309
2024-03-19 21:54:58,012 - root - INFO - Predicted timestep 3 of 8. z500 RMS Error: 64.06492614746094, ACC: 0.9987519979476929
2024-03-19 21:54:58,166 - root - INFO - Predicted timestep 4 of 8. z500 RMS Error: 82.7522201538086, ACC: 0.9979271292686462
2024-03-19 21:54:58,319 - root - INFO - Predicted timestep 5 of 8. z500 RMS Error: 97.86416625976562, ACC: 0.9970927238464355
2024-03-19 21:54:58,472 - root - INFO - Predicted timestep 6 of 8. z500 RMS Error: 116.19584655761719, ACC: 0.9959009289741516
2024-03-19 21:54:58,625 - root - INFO - Predicted timestep 7 of 8. z500 RMS Error: 132.14974975585938, ACC: 0.9947429299354553
2024-03-19 21:54:59,779 - root - WARNING -  saved real and predicted with shape (1, 8, 20, 720, 1440) (1, 8, 20, 720, 1440) with np_save 19_January_00_2018 
2024-03-19 21:54:59,779 - root - WARNING - Initial condition 4 of 10 with corresponidng time  =  28_January_00_2018 and valid_year 2018
2024-03-19 21:55:00,503 - root - INFO - Begin autoregressive inference
2024-03-19 21:55:00,655 - root - INFO - Predicted timestep 0 of 8. z500 RMS Error: 0.0, ACC: 1.0
2024-03-19 21:55:00,807 - root - INFO - Predicted timestep 1 of 8. z500 RMS Error: 40.4893913269043, ACC: 0.9995498657226562
2024-03-19 21:55:00,960 - root - INFO - Predicted timestep 2 of 8. z500 RMS Error: 52.22865295410156, ACC: 0.9992458820343018
2024-03-19 21:55:01,113 - root - INFO - Predicted timestep 3 of 8. z500 RMS Error: 62.845741271972656, ACC: 0.998900294303894
2024-03-19 21:55:01,266 - root - INFO - Predicted timestep 4 of 8. z500 RMS Error: 82.02289581298828, ACC: 0.9981224536895752
2024-03-19 21:55:01,419 - root - INFO - Predicted timestep 5 of 8. z500 RMS Error: 100.29154205322266, ACC: 0.9971843361854553
2024-03-19 21:55:01,572 - root - INFO - Predicted timestep 6 of 8. z500 RMS Error: 120.46273040771484, ACC: 0.9959070682525635
2024-03-19 21:55:01,723 - root - INFO - Predicted timestep 7 of 8. z500 RMS Error: 143.21377563476562, ACC: 0.9942840933799744
2024-03-19 21:55:02,797 - root - WARNING -  saved real and predicted with shape (1, 8, 20, 720, 1440) (1, 8, 20, 720, 1440) with np_save 28_January_00_2018 
2024-03-19 21:55:02,797 - root - WARNING - Initial condition 5 of 10 with corresponidng time  =  06_February_00_2018 and valid_year 2018
2024-03-19 21:55:03,515 - root - INFO - Begin autoregressive inference
2024-03-19 21:55:03,667 - root - INFO - Predicted timestep 0 of 8. z500 RMS Error: 0.0, ACC: 1.0
2024-03-19 21:55:03,820 - root - INFO - Predicted timestep 1 of 8. z500 RMS Error: 40.481136322021484, ACC: 0.9996451139450073
2024-03-19 21:55:03,972 - root - INFO - Predicted timestep 2 of 8. z500 RMS Error: 57.44785690307617, ACC: 0.9992781281471252
2024-03-19 21:55:04,126 - root - INFO - Predicted timestep 3 of 8. z500 RMS Error: 72.76214599609375, ACC: 0.9988397359848022
2024-03-19 21:55:04,279 - root - INFO - Predicted timestep 4 of 8. z500 RMS Error: 91.57139587402344, ACC: 0.9981630444526672
2024-03-19 21:55:04,433 - root - INFO - Predicted timestep 5 of 8. z500 RMS Error: 108.3152847290039, ACC: 0.997439980506897
2024-03-19 21:55:04,585 - root - INFO - Predicted timestep 6 of 8. z500 RMS Error: 128.69366455078125, ACC: 0.996364176273346
2024-03-19 21:55:04,738 - root - INFO - Predicted timestep 7 of 8. z500 RMS Error: 147.7533416748047, ACC: 0.9952389597892761
2024-03-19 21:55:05,803 - root - WARNING -  saved real and predicted with shape (1, 8, 20, 720, 1440) (1, 8, 20, 720, 1440) with np_save 06_February_00_2018 
2024-03-19 21:55:05,803 - root - WARNING - Initial condition 6 of 10 with corresponidng time  =  15_February_00_2018 and valid_year 2018
2024-03-19 21:55:06,528 - root - INFO - Begin autoregressive inference
2024-03-19 21:55:06,681 - root - INFO - Predicted timestep 0 of 8. z500 RMS Error: 0.0, ACC: 1.0
2024-03-19 21:55:06,833 - root - INFO - Predicted timestep 1 of 8. z500 RMS Error: 39.718048095703125, ACC: 0.9996256232261658
2024-03-19 21:55:06,986 - root - INFO - Predicted timestep 2 of 8. z500 RMS Error: 57.09104919433594, ACC: 0.9992268085479736
2024-03-19 21:55:07,139 - root - INFO - Predicted timestep 3 of 8. z500 RMS Error: 70.63634490966797, ACC: 0.9987655878067017
2024-03-19 21:55:07,291 - root - INFO - Predicted timestep 4 of 8. z500 RMS Error: 87.80720520019531, ACC: 0.998060405254364
2024-03-19 21:55:07,444 - root - INFO - Predicted timestep 5 of 8. z500 RMS Error: 105.1732406616211, ACC: 0.9971781373023987
2024-03-19 21:55:07,597 - root - INFO - Predicted timestep 6 of 8. z500 RMS Error: 122.47148895263672, ACC: 0.996116578578949
2024-03-19 21:55:07,750 - root - INFO - Predicted timestep 7 of 8. z500 RMS Error: 136.8862762451172, ACC: 0.9951531291007996
2024-03-19 21:55:08,812 - root - WARNING -  saved real and predicted with shape (1, 8, 20, 720, 1440) (1, 8, 20, 720, 1440) with np_save 15_February_00_2018 
2024-03-19 21:55:08,812 - root - WARNING - Initial condition 7 of 10 with corresponidng time  =  24_February_00_2018 and valid_year 2018
2024-03-19 21:55:09,528 - root - INFO - Begin autoregressive inference
2024-03-19 21:55:09,680 - root - INFO - Predicted timestep 0 of 8. z500 RMS Error: 0.0, ACC: 1.0
2024-03-19 21:55:09,833 - root - INFO - Predicted timestep 1 of 8. z500 RMS Error: 39.98298263549805, ACC: 0.9996182322502136
2024-03-19 21:55:09,985 - root - INFO - Predicted timestep 2 of 8. z500 RMS Error: 58.585636138916016, ACC: 0.999182403087616
2024-03-19 21:55:10,138 - root - INFO - Predicted timestep 3 of 8. z500 RMS Error: 70.41835021972656, ACC: 0.9988466501235962
2024-03-19 21:55:10,290 - root - INFO - Predicted timestep 4 of 8. z500 RMS Error: 87.94905090332031, ACC: 0.9981626868247986
2024-03-19 21:55:10,443 - root - INFO - Predicted timestep 5 of 8. z500 RMS Error: 108.07262420654297, ACC: 0.9971847534179688
2024-03-19 21:55:10,597 - root - INFO - Predicted timestep 6 of 8. z500 RMS Error: 133.9787139892578, ACC: 0.9956145882606506
2024-03-19 21:55:10,750 - root - INFO - Predicted timestep 7 of 8. z500 RMS Error: 160.52780151367188, ACC: 0.9937047958374023
2024-03-19 21:55:11,785 - root - WARNING -  saved real and predicted with shape (1, 8, 20, 720, 1440) (1, 8, 20, 720, 1440) with np_save 24_February_00_2018 
2024-03-19 21:55:11,786 - root - WARNING - Initial condition 8 of 10 with corresponidng time  =  05_March_00_2018 and valid_year 2018
2024-03-19 21:55:12,501 - root - INFO - Begin autoregressive inference
2024-03-19 21:55:12,653 - root - INFO - Predicted timestep 0 of 8. z500 RMS Error: 0.0, ACC: 1.0
2024-03-19 21:55:12,805 - root - INFO - Predicted timestep 1 of 8. z500 RMS Error: 34.423553466796875, ACC: 0.999656617641449
2024-03-19 21:55:12,958 - root - INFO - Predicted timestep 2 of 8. z500 RMS Error: 49.0748405456543, ACC: 0.9993000626564026
2024-03-19 21:55:13,111 - root - INFO - Predicted timestep 3 of 8. z500 RMS Error: 57.91379165649414, ACC: 0.9989942312240601
2024-03-19 21:55:13,263 - root - INFO - Predicted timestep 4 of 8. z500 RMS Error: 78.26386260986328, ACC: 0.9981685280799866
2024-03-19 21:55:13,416 - root - INFO - Predicted timestep 5 of 8. z500 RMS Error: 89.12337493896484, ACC: 0.9976483583450317
2024-03-19 21:55:13,570 - root - INFO - Predicted timestep 6 of 8. z500 RMS Error: 108.42176055908203, ACC: 0.9964566826820374
2024-03-19 21:55:13,723 - root - INFO - Predicted timestep 7 of 8. z500 RMS Error: 122.80377960205078, ACC: 0.9954012036323547
2024-03-19 21:55:14,773 - root - WARNING -  saved real and predicted with shape (1, 8, 20, 720, 1440) (1, 8, 20, 720, 1440) with np_save 05_March_00_2018 
2024-03-19 21:55:14,773 - root - WARNING - Initial condition 9 of 10 with corresponidng time  =  14_March_00_2018 and valid_year 2018
2024-03-19 21:55:15,480 - root - INFO - Begin autoregressive inference
2024-03-19 21:55:15,632 - root - INFO - Predicted timestep 0 of 8. z500 RMS Error: 0.0, ACC: 1.0
2024-03-19 21:55:15,784 - root - INFO - Predicted timestep 1 of 8. z500 RMS Error: 34.316184997558594, ACC: 0.9996668696403503
2024-03-19 21:55:15,936 - root - INFO - Predicted timestep 2 of 8. z500 RMS Error: 52.199031829833984, ACC: 0.9992451071739197
2024-03-19 21:55:16,090 - root - INFO - Predicted timestep 3 of 8. z500 RMS Error: 67.4875717163086, ACC: 0.9987603425979614
2024-03-19 21:55:16,244 - root - INFO - Predicted timestep 4 of 8. z500 RMS Error: 91.89934539794922, ACC: 0.9977535009384155
2024-03-19 21:55:16,397 - root - INFO - Predicted timestep 5 of 8. z500 RMS Error: 112.46349334716797, ACC: 0.9967042803764343
2024-03-19 21:55:16,551 - root - INFO - Predicted timestep 6 of 8. z500 RMS Error: 135.7175750732422, ACC: 0.9952130913734436
2024-03-19 21:55:16,703 - root - INFO - Predicted timestep 7 of 8. z500 RMS Error: 158.6426239013672, ACC: 0.9934440851211548
2024-03-19 21:55:17,724 - root - WARNING -  saved real and predicted with shape (1, 8, 20, 720, 1440) (1, 8, 20, 720, 1440) with np_save 14_March_00_2018 
2024-03-19 21:55:17,725 - root - WARNING - Initial condition 10 of 10 with corresponidng time  =  23_March_00_2018 and valid_year 2018
2024-03-19 21:55:18,448 - root - INFO - Begin autoregressive inference
2024-03-19 21:55:18,600 - root - INFO - Predicted timestep 0 of 8. z500 RMS Error: 0.0, ACC: 1.0
2024-03-19 21:55:18,752 - root - INFO - Predicted timestep 1 of 8. z500 RMS Error: 36.96066665649414, ACC: 0.9996141195297241
2024-03-19 21:55:18,905 - root - INFO - Predicted timestep 2 of 8. z500 RMS Error: 53.25741195678711, ACC: 0.9991965293884277
2024-03-19 21:55:19,059 - root - INFO - Predicted timestep 3 of 8. z500 RMS Error: 67.00923919677734, ACC: 0.9987416863441467
2024-03-19 21:55:19,211 - root - INFO - Predicted timestep 4 of 8. z500 RMS Error: 87.139404296875, ACC: 0.9979001879692078
2024-03-19 21:55:19,365 - root - INFO - Predicted timestep 5 of 8. z500 RMS Error: 101.99374389648438, ACC: 0.9971166253089905
2024-03-19 21:55:19,518 - root - INFO - Predicted timestep 6 of 8. z500 RMS Error: 119.45429992675781, ACC: 0.9959083199501038
2024-03-19 21:55:19,671 - root - INFO - Predicted timestep 7 of 8. z500 RMS Error: 136.1692352294922, ACC: 0.994572103023529
2024-03-19 21:55:20,694 - root - WARNING -  saved real and predicted with shape (1, 8, 20, 720, 1440) (1, 8, 20, 720, 1440) with np_save 23_March_00_2018 
2024-03-19 21:55:20,694 - root - INFO - Shapes: seq_real (1, 8, 20, 720, 1440), seq_pred (1, 8, 20, 720, 1440), valid_loss (10, 8, 20), valid_loss_coarse (10, 8, 20), acc (10, 8, 20), acc_coarse (10, 8, 20), acc_coarse_unweighted (10, 8, 20), acc_unweighted (10, 8, 20), acc_land (10, 8, 20), acc_sea (10, 8, 20)
2024-03-19 21:55:20,694 - root - INFO - Saving files at /scratch/gilbreth/gupt1075/ERA5_expts_march_19/afno_backbone/222/autoregressive_predictions_z500.h5
2024-03-19 21:55:20,694 - root - WARNING -  >>> ONLY_FLD (10, 8)  (10, 8) 
2024-03-19 21:57:05,629 - root - WARNING - ------------------ Configuration ------------------
2024-03-19 21:57:05,648 - root - WARNING -  Key: log_to_wandb : True 
2024-03-19 21:57:05,648 - root - WARNING -  Key: lr : 0.0005 
2024-03-19 21:57:05,648 - root - WARNING -  Key: batch_size : 64 
2024-03-19 21:57:05,648 - root - WARNING -  Key: max_epochs : 150 
2024-03-19 21:57:05,648 - root - WARNING -  Key: scheduler : CosineAnnealingLR 
2024-03-19 21:57:05,648 - root - WARNING -  Key: in_channels : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19] 
2024-03-19 21:57:05,648 - root - WARNING -  Key: out_channels : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19] 
2024-03-19 21:57:05,648 - root - WARNING -  Key: orography : False 
2024-03-19 21:57:05,648 - root - WARNING -  Key: orography_path : /scratch/gilbreth/wwtung/FourCastNet/data/static/orography.h5 
2024-03-19 21:57:05,648 - root - WARNING -  Key: exp_dir : /scratch/gilbreth/gupt1075/ERA5_expts_gtc/ 
2024-03-19 21:57:05,648 - root - WARNING -  Key: train_data_path : /scratch/gilbreth/wwtung/FourCastNet/data/train/ 
2024-03-19 21:57:05,648 - root - WARNING -  Key: valid_data_path : /scratch/gilbreth/wwtung/FourCastNet/data/test/ 
2024-03-19 21:57:05,648 - root - WARNING -  Key: inf_data_path : /scratch/gilbreth/wwtung/FourCastNet/data/out_of_sample 
2024-03-19 21:57:05,649 - root - WARNING -  Key: time_means_path : /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/time_means.npy 
2024-03-19 21:57:05,649 - root - WARNING -  Key: global_means_path : /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/global_means.npy 
2024-03-19 21:57:05,649 - root - WARNING -  Key: global_stds_path : /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/global_stds.npy 
2024-03-19 21:57:05,649 - root - WARNING -  Key: loss : l2 
2024-03-19 21:57:05,649 - root - WARNING -  Key: num_data_workers : 8 
2024-03-19 21:57:05,649 - root - WARNING -  Key: dt : 1 
2024-03-19 21:57:05,649 - root - WARNING -  Key: n_history : 0 
2024-03-19 21:57:05,649 - root - WARNING -  Key: prediction_type : iterative 
2024-03-19 21:57:05,649 - root - WARNING -  Key: prediction_length : 8 
2024-03-19 21:57:05,649 - root - WARNING -  Key: n_initial_conditions : 10 
2024-03-19 21:57:05,649 - root - WARNING -  Key: ics_type : default 
2024-03-19 21:57:05,649 - root - WARNING -  Key: save_raw_forecasts : True 
2024-03-19 21:57:05,649 - root - WARNING -  Key: save_channel : False 
2024-03-19 21:57:05,649 - root - WARNING -  Key: masked_acc : False 
2024-03-19 21:57:05,649 - root - WARNING -  Key: maskpath : None 
2024-03-19 21:57:05,649 - root - WARNING -  Key: perturb : False 
2024-03-19 21:57:05,649 - root - WARNING -  Key: add_grid : False 
2024-03-19 21:57:05,649 - root - WARNING -  Key: N_grid_channels : 0 
2024-03-19 21:57:05,649 - root - WARNING -  Key: gridtype : sinusoidal 
2024-03-19 21:57:05,649 - root - WARNING -  Key: roll : False 
2024-03-19 21:57:05,649 - root - WARNING -  Key: num_blocks : 8 
2024-03-19 21:57:05,649 - root - WARNING -  Key: nettype : afno 
2024-03-19 21:57:05,649 - root - WARNING -  Key: patch_size : 8 
2024-03-19 21:57:05,649 - root - WARNING -  Key: width : 56 
2024-03-19 21:57:05,649 - root - WARNING -  Key: modes : 32 
2024-03-19 21:57:05,649 - root - WARNING -  Key: target : default 
2024-03-19 21:57:05,649 - root - WARNING -  Key: normalization : zscore 
2024-03-19 21:57:05,649 - root - WARNING -  Key: log_to_screen : True 
2024-03-19 21:57:05,649 - root - WARNING -  Key: save_checkpoint : True 
2024-03-19 21:57:05,649 - root - WARNING -  Key: enable_nhwc : False 
2024-03-19 21:57:05,649 - root - WARNING -  Key: optimizer_type : Adam 
2024-03-19 21:57:05,649 - root - WARNING -  Key: crop_size_x : None 
2024-03-19 21:57:05,649 - root - WARNING -  Key: crop_size_y : None 
2024-03-19 21:57:05,649 - root - WARNING -  Key: two_step_training : False 
2024-03-19 21:57:05,649 - root - WARNING -  Key: plot_animations : False 
2024-03-19 21:57:05,649 - root - WARNING -  Key: add_noise : False 
2024-03-19 21:57:05,649 - root - WARNING -  Key: noise_std : 0 
2024-03-19 21:57:05,650 - root - WARNING - ---------------------------------------------------
2024-03-19 21:57:05,819 - root - INFO - ------------------ Configuration ------------------
2024-03-19 21:57:05,819 - root - INFO - Configuration file: /scratch/gilbreth/gupt1075/FourCastNet_gil/config/AFNO.yaml
2024-03-19 21:57:05,819 - root - INFO - Configuration name: afno_backbone
2024-03-19 21:57:05,819 - root - INFO - log_to_wandb True
2024-03-19 21:57:05,819 - root - INFO - lr 0.0005
2024-03-19 21:57:05,819 - root - INFO - batch_size 64
2024-03-19 21:57:05,819 - root - INFO - max_epochs 150
2024-03-19 21:57:05,819 - root - INFO - scheduler CosineAnnealingLR
2024-03-19 21:57:05,819 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2024-03-19 21:57:05,819 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2024-03-19 21:57:05,819 - root - INFO - orography False
2024-03-19 21:57:05,819 - root - INFO - orography_path /scratch/gilbreth/wwtung/FourCastNet/data/static/orography.h5
2024-03-19 21:57:05,820 - root - INFO - exp_dir /scratch/gilbreth/gupt1075/ERA5_expts_gtc/
2024-03-19 21:57:05,820 - root - INFO - train_data_path /scratch/gilbreth/wwtung/FourCastNet/data/train/
2024-03-19 21:57:05,820 - root - INFO - valid_data_path /scratch/gilbreth/wwtung/FourCastNet/data/test/
2024-03-19 21:57:05,820 - root - INFO - inf_data_path /scratch/gilbreth/wwtung/FourCastNet/data/out_of_sample
2024-03-19 21:57:05,820 - root - INFO - time_means_path /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/time_means.npy
2024-03-19 21:57:05,820 - root - INFO - global_means_path /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/global_means.npy
2024-03-19 21:57:05,820 - root - INFO - global_stds_path /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/global_stds.npy
2024-03-19 21:57:05,820 - root - INFO - loss l2
2024-03-19 21:57:05,820 - root - INFO - num_data_workers 8
2024-03-19 21:57:05,820 - root - INFO - dt 1
2024-03-19 21:57:05,820 - root - INFO - n_history 0
2024-03-19 21:57:05,820 - root - INFO - prediction_type iterative
2024-03-19 21:57:05,820 - root - INFO - prediction_length 8
2024-03-19 21:57:05,820 - root - INFO - n_initial_conditions 10
2024-03-19 21:57:05,820 - root - INFO - ics_type default
2024-03-19 21:57:05,820 - root - INFO - save_raw_forecasts True
2024-03-19 21:57:05,820 - root - INFO - save_channel False
2024-03-19 21:57:05,820 - root - INFO - masked_acc False
2024-03-19 21:57:05,820 - root - INFO - maskpath None
2024-03-19 21:57:05,820 - root - INFO - perturb False
2024-03-19 21:57:05,820 - root - INFO - add_grid False
2024-03-19 21:57:05,820 - root - INFO - N_grid_channels 0
2024-03-19 21:57:05,820 - root - INFO - gridtype sinusoidal
2024-03-19 21:57:05,820 - root - INFO - roll False
2024-03-19 21:57:05,820 - root - INFO - num_blocks 8
2024-03-19 21:57:05,820 - root - INFO - nettype afno
2024-03-19 21:57:05,820 - root - INFO - patch_size 8
2024-03-19 21:57:05,820 - root - INFO - width 56
2024-03-19 21:57:05,820 - root - INFO - modes 32
2024-03-19 21:57:05,820 - root - INFO - target default
2024-03-19 21:57:05,820 - root - INFO - normalization zscore
2024-03-19 21:57:05,820 - root - INFO - log_to_screen True
2024-03-19 21:57:05,820 - root - INFO - save_checkpoint True
2024-03-19 21:57:05,820 - root - INFO - enable_nhwc False
2024-03-19 21:57:05,820 - root - INFO - optimizer_type Adam
2024-03-19 21:57:05,820 - root - INFO - crop_size_x None
2024-03-19 21:57:05,820 - root - INFO - crop_size_y None
2024-03-19 21:57:05,820 - root - INFO - two_step_training False
2024-03-19 21:57:05,820 - root - INFO - plot_animations False
2024-03-19 21:57:05,820 - root - INFO - add_noise False
2024-03-19 21:57:05,820 - root - INFO - noise_std 0
2024-03-19 21:57:05,820 - root - INFO - fld z500
2024-03-19 21:57:05,820 - root - INFO - world_size 1
2024-03-19 21:57:05,820 - root - INFO - interp 0
2024-03-19 21:57:05,820 - root - INFO - use_daily_climatology False
2024-03-19 21:57:05,820 - root - INFO - global_batch_size 64
2024-03-19 21:57:05,821 - root - INFO - idxes {'u10': 0, 'z500': 14, '2m_temperature': 2, 'v10': 1, 't850': 5}
2024-03-19 21:57:05,821 - root - INFO - DECORRELATION_TIME 36
2024-03-19 21:57:05,821 - root - INFO - experiment_dir /scratch/gilbreth/gupt1075/ERA5_expts_march_19/afno_backbone/222
2024-03-19 21:57:05,821 - root - INFO - best_checkpoint_path /scratch/gilbreth/wwtung/FourCastNet/model_weights/FCN_weights_v0/backbone.ckpt
2024-03-19 21:57:05,821 - root - INFO - resuming False
2024-03-19 21:57:05,821 - root - INFO - local_rank 0
2024-03-19 21:57:05,821 - root - INFO - ---------------------------------------------------
2024-03-19 21:57:05,821 - root - WARNING -  
 ICS for default: [  0  36  72 108 144 180 216 252 288 324] num_samples 1328  prediction_lnegth: 8   
2024-03-19 21:57:05,823 - root - WARNING - Getting file stats from /scratch/gilbreth/wwtung/FourCastNet/data/out_of_sample/2018.h5
2024-03-19 21:57:05,824 - root - WARNING -  n_years: 1  
 n_samples_per_yeaer: 1460 
 dt: 1  n_history: 0 
2024-03-19 21:57:05,824 - root - WARNING - Number of samples per year: 1460
2024-03-19 21:57:05,824 - root - WARNING - Found data at path /scratch/gilbreth/wwtung/FourCastNet/data/out_of_sample. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2024-03-19 21:57:05,824 - root - WARNING - Delta t: 6 hours
2024-03-19 21:57:05,824 - root - WARNING - Including 0 hours of past history in training at a frequency of 6 hours
2024-03-19 21:57:05,824 - root - INFO - Loading trained model checkpoint from /scratch/gilbreth/wwtung/FourCastNet/model_weights/FCN_weights_v0/backbone.ckpt
2024-03-19 21:57:05,826 - root - INFO -  in_channels  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19] 20   >>   out_channels [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19] 20  params.global_means_path /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/global_means.npy params.global_stds_path /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/global_stds.npy  
2024-03-19 21:57:08,452 - root - INFO -  in_channels 20   out_channels 20  params.global_means_path /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/global_means.npy params.global_stds_path /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/global_stds.npy  
2024-03-19 21:57:08,453 - root - INFO -  Loading validation data from ['/scratch/gilbreth/wwtung/FourCastNet/data/out_of_sample/2018.h5']
2024-03-19 21:57:08,453 - root - WARNING -  valid_year 2018   
2024-03-19 21:57:08,454 - root - WARNING - Initial condition 1 of 10 with corresponidng time  =  01_January_00_2018 and valid_year 2018
2024-03-19 21:57:09,143 - root - INFO - Begin autoregressive inference
2024-03-19 21:57:09,718 - root - WARNING -  >> MODEL_summary: ============================================================================================================================================
Layer (type (var_name))                  Input Shape               Output Shape              Param #                   Trainable
============================================================================================================================================
AFNONet (AFNONet)                        [1, 20, 720, 1440]        [1, 20, 720, 1440]        12,443,136                True
├─PatchEmbed (patch_embed)               [1, 20, 720, 1440]        [1, 16200, 768]           --                        True
│    └─Conv2d (proj)                     [1, 20, 720, 1440]        [1, 768, 90, 180]         983,808                   True
├─Dropout (pos_drop)                     [1, 16200, 768]           [1, 16200, 768]           --                        --
├─ModuleList (blocks)                    --                        --                        --                        True
│    └─Block (0)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (1)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (2)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (3)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (4)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (5)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (6)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (7)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (8)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (9)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (10)                        [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (11)                        [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
├─Linear (head)                          [1, 90, 180, 768]         [1, 90, 180, 1280]        983,040                   True
============================================================================================================================================
Total params: 74,691,840
Trainable params: 74,691,840
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 16.00
============================================================================================================================================
Input size (MB): 663.55
Forward/backward pass size (MB): 9820.57
Params size (MB): 248.99
Estimated Total Size (MB): 10733.12
============================================================================================================================================ 

2024-03-19 21:57:09,993 - root - INFO - Predicted timestep 0 of 8. z500 RMS Error: 0.0, ACC: 1.0
2024-03-19 21:57:11,239 - root - INFO - Predicted timestep 1 of 8. z500 RMS Error: 34.425804138183594, ACC: 0.9996493458747864
2024-03-19 21:57:11,390 - root - INFO - Predicted timestep 2 of 8. z500 RMS Error: 48.357078552246094, ACC: 0.9993206262588501
2024-03-19 21:57:11,543 - root - INFO - Predicted timestep 3 of 8. z500 RMS Error: 63.70835494995117, ACC: 0.9988381862640381
2024-03-19 21:57:11,695 - root - INFO - Predicted timestep 4 of 8. z500 RMS Error: 81.07498931884766, ACC: 0.9981367588043213
2024-03-19 21:57:11,847 - root - INFO - Predicted timestep 5 of 8. z500 RMS Error: 92.77654266357422, ACC: 0.9976038336753845
2024-03-19 21:57:12,000 - root - INFO - Predicted timestep 6 of 8. z500 RMS Error: 109.06070709228516, ACC: 0.9967321753501892
2024-03-19 21:57:12,151 - root - INFO - Predicted timestep 7 of 8. z500 RMS Error: 122.5030288696289, ACC: 0.9959385395050049
2024-03-19 21:57:12,321 - root - WARNING -  >>> saving predicted /scratch/gilbreth/gupt1075/ERA5_expts_march_19/afno_backbone/222/seq_pred_0_datetime_01_January_00_2018.npy 
2024-03-19 21:57:13,015 - root - WARNING -  >>> saving original /scratch/gilbreth/gupt1075/ERA5_expts_march_19/afno_backbone/222/seq_real_0_datetime_01_January_00_2018.npy 
2024-03-19 21:57:13,015 - root - WARNING -  saved real and predicted with shape (1, 8, 20, 720, 1440) (1, 8, 20, 720, 1440) with np_save 01_January_00_2018 
2024-03-19 21:57:13,015 - root - WARNING - Initial condition 2 of 10 with corresponidng time  =  10_January_00_2018 and valid_year 2018
2024-03-19 21:57:13,703 - root - INFO - Begin autoregressive inference
2024-03-19 21:57:13,729 - root - WARNING -  >> MODEL_summary: ============================================================================================================================================
Layer (type (var_name))                  Input Shape               Output Shape              Param #                   Trainable
============================================================================================================================================
AFNONet (AFNONet)                        [1, 20, 720, 1440]        [1, 20, 720, 1440]        12,443,136                True
├─PatchEmbed (patch_embed)               [1, 20, 720, 1440]        [1, 16200, 768]           --                        True
│    └─Conv2d (proj)                     [1, 20, 720, 1440]        [1, 768, 90, 180]         983,808                   True
├─Dropout (pos_drop)                     [1, 16200, 768]           [1, 16200, 768]           --                        --
├─ModuleList (blocks)                    --                        --                        --                        True
│    └─Block (0)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (1)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (2)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (3)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (4)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (5)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (6)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (7)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (8)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (9)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (10)                        [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (11)                        [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
├─Linear (head)                          [1, 90, 180, 768]         [1, 90, 180, 1280]        983,040                   True
============================================================================================================================================
Total params: 74,691,840
Trainable params: 74,691,840
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 16.00
============================================================================================================================================
Input size (MB): 663.55
Forward/backward pass size (MB): 9820.57
Params size (MB): 248.99
Estimated Total Size (MB): 10733.12
============================================================================================================================================ 

2024-03-19 21:57:14,007 - root - INFO - Predicted timestep 0 of 8. z500 RMS Error: 0.0, ACC: 1.0
2024-03-19 21:57:14,160 - root - INFO - Predicted timestep 1 of 8. z500 RMS Error: 37.18465042114258, ACC: 0.999663233757019
2024-03-19 21:57:14,312 - root - INFO - Predicted timestep 2 of 8. z500 RMS Error: 52.85227966308594, ACC: 0.9993199706077576
2024-03-19 21:57:14,464 - root - INFO - Predicted timestep 3 of 8. z500 RMS Error: 71.33325958251953, ACC: 0.998769223690033
2024-03-19 21:57:14,616 - root - INFO - Predicted timestep 4 of 8. z500 RMS Error: 89.89252471923828, ACC: 0.9980303645133972
2024-03-19 21:57:14,769 - root - INFO - Predicted timestep 5 of 8. z500 RMS Error: 105.95235443115234, ACC: 0.997300922870636
2024-03-19 21:57:14,921 - root - INFO - Predicted timestep 6 of 8. z500 RMS Error: 126.47808837890625, ACC: 0.9961051344871521
2024-03-19 21:57:15,073 - root - INFO - Predicted timestep 7 of 8. z500 RMS Error: 138.492919921875, ACC: 0.9953263998031616
2024-03-19 21:57:15,262 - root - WARNING -  >>> saving predicted /scratch/gilbreth/gupt1075/ERA5_expts_march_19/afno_backbone/222/seq_pred_1_datetime_10_January_00_2018.npy 
2024-03-19 21:57:16,095 - root - WARNING -  >>> saving original /scratch/gilbreth/gupt1075/ERA5_expts_march_19/afno_backbone/222/seq_real_1_datetime_10_January_00_2018.npy 
2024-03-19 21:57:16,095 - root - WARNING -  saved real and predicted with shape (1, 8, 20, 720, 1440) (1, 8, 20, 720, 1440) with np_save 10_January_00_2018 
2024-03-19 21:57:16,095 - root - WARNING - Initial condition 3 of 10 with corresponidng time  =  19_January_00_2018 and valid_year 2018
2024-03-19 21:57:16,787 - root - INFO - Begin autoregressive inference
2024-03-19 21:57:16,814 - root - WARNING -  >> MODEL_summary: ============================================================================================================================================
Layer (type (var_name))                  Input Shape               Output Shape              Param #                   Trainable
============================================================================================================================================
AFNONet (AFNONet)                        [1, 20, 720, 1440]        [1, 20, 720, 1440]        12,443,136                True
├─PatchEmbed (patch_embed)               [1, 20, 720, 1440]        [1, 16200, 768]           --                        True
│    └─Conv2d (proj)                     [1, 20, 720, 1440]        [1, 768, 90, 180]         983,808                   True
├─Dropout (pos_drop)                     [1, 16200, 768]           [1, 16200, 768]           --                        --
├─ModuleList (blocks)                    --                        --                        --                        True
│    └─Block (0)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (1)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (2)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (3)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (4)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (5)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (6)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (7)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (8)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (9)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (10)                        [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (11)                        [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
├─Linear (head)                          [1, 90, 180, 768]         [1, 90, 180, 1280]        983,040                   True
============================================================================================================================================
Total params: 74,691,840
Trainable params: 74,691,840
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 16.00
============================================================================================================================================
Input size (MB): 663.55
Forward/backward pass size (MB): 9820.57
Params size (MB): 248.99
Estimated Total Size (MB): 10733.12
============================================================================================================================================ 

2024-03-19 21:57:17,092 - root - INFO - Predicted timestep 0 of 8. z500 RMS Error: 0.0, ACC: 1.0
2024-03-19 21:57:17,244 - root - INFO - Predicted timestep 1 of 8. z500 RMS Error: 35.458255767822266, ACC: 0.9996299147605896
2024-03-19 21:57:17,395 - root - INFO - Predicted timestep 2 of 8. z500 RMS Error: 52.08525848388672, ACC: 0.9991850852966309
2024-03-19 21:57:17,548 - root - INFO - Predicted timestep 3 of 8. z500 RMS Error: 64.06492614746094, ACC: 0.9987519979476929
2024-03-19 21:57:17,700 - root - INFO - Predicted timestep 4 of 8. z500 RMS Error: 82.7522201538086, ACC: 0.9979271292686462
2024-03-19 21:57:17,852 - root - INFO - Predicted timestep 5 of 8. z500 RMS Error: 97.86416625976562, ACC: 0.9970927238464355
2024-03-19 21:57:18,005 - root - INFO - Predicted timestep 6 of 8. z500 RMS Error: 116.19584655761719, ACC: 0.9959009289741516
2024-03-19 21:57:18,158 - root - INFO - Predicted timestep 7 of 8. z500 RMS Error: 132.14974975585938, ACC: 0.9947429299354553
2024-03-19 21:57:18,351 - root - WARNING -  >>> saving predicted /scratch/gilbreth/gupt1075/ERA5_expts_march_19/afno_backbone/222/seq_pred_2_datetime_19_January_00_2018.npy 
2024-03-19 21:57:18,994 - root - WARNING -  >>> saving original /scratch/gilbreth/gupt1075/ERA5_expts_march_19/afno_backbone/222/seq_real_2_datetime_19_January_00_2018.npy 
2024-03-19 21:57:18,994 - root - WARNING -  saved real and predicted with shape (1, 8, 20, 720, 1440) (1, 8, 20, 720, 1440) with np_save 19_January_00_2018 
2024-03-19 21:57:18,994 - root - WARNING - Initial condition 4 of 10 with corresponidng time  =  28_January_00_2018 and valid_year 2018
2024-03-19 21:57:19,692 - root - INFO - Begin autoregressive inference
2024-03-19 21:57:19,718 - root - WARNING -  >> MODEL_summary: ============================================================================================================================================
Layer (type (var_name))                  Input Shape               Output Shape              Param #                   Trainable
============================================================================================================================================
AFNONet (AFNONet)                        [1, 20, 720, 1440]        [1, 20, 720, 1440]        12,443,136                True
├─PatchEmbed (patch_embed)               [1, 20, 720, 1440]        [1, 16200, 768]           --                        True
│    └─Conv2d (proj)                     [1, 20, 720, 1440]        [1, 768, 90, 180]         983,808                   True
├─Dropout (pos_drop)                     [1, 16200, 768]           [1, 16200, 768]           --                        --
├─ModuleList (blocks)                    --                        --                        --                        True
│    └─Block (0)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (1)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (2)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (3)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (4)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (5)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (6)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (7)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (8)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (9)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (10)                        [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (11)                        [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
├─Linear (head)                          [1, 90, 180, 768]         [1, 90, 180, 1280]        983,040                   True
============================================================================================================================================
Total params: 74,691,840
Trainable params: 74,691,840
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 16.00
============================================================================================================================================
Input size (MB): 663.55
Forward/backward pass size (MB): 9820.57
Params size (MB): 248.99
Estimated Total Size (MB): 10733.12
============================================================================================================================================ 

2024-03-19 21:57:19,996 - root - INFO - Predicted timestep 0 of 8. z500 RMS Error: 0.0, ACC: 1.0
2024-03-19 21:57:20,149 - root - INFO - Predicted timestep 1 of 8. z500 RMS Error: 40.4893913269043, ACC: 0.9995498657226562
2024-03-19 21:57:20,301 - root - INFO - Predicted timestep 2 of 8. z500 RMS Error: 52.22865295410156, ACC: 0.9992458820343018
2024-03-19 21:57:20,454 - root - INFO - Predicted timestep 3 of 8. z500 RMS Error: 62.845741271972656, ACC: 0.998900294303894
2024-03-19 21:57:20,606 - root - INFO - Predicted timestep 4 of 8. z500 RMS Error: 82.02289581298828, ACC: 0.9981224536895752
2024-03-19 21:57:20,758 - root - INFO - Predicted timestep 5 of 8. z500 RMS Error: 100.29154205322266, ACC: 0.9971843361854553
2024-03-19 21:57:20,911 - root - INFO - Predicted timestep 6 of 8. z500 RMS Error: 120.46273040771484, ACC: 0.9959070682525635
2024-03-19 21:57:21,064 - root - INFO - Predicted timestep 7 of 8. z500 RMS Error: 143.21377563476562, ACC: 0.9942840933799744
2024-03-19 21:57:21,254 - root - WARNING -  >>> saving predicted /scratch/gilbreth/gupt1075/ERA5_expts_march_19/afno_backbone/222/seq_pred_3_datetime_28_January_00_2018.npy 
2024-03-19 21:57:21,932 - root - WARNING -  >>> saving original /scratch/gilbreth/gupt1075/ERA5_expts_march_19/afno_backbone/222/seq_real_3_datetime_28_January_00_2018.npy 
2024-03-19 21:57:21,932 - root - WARNING -  saved real and predicted with shape (1, 8, 20, 720, 1440) (1, 8, 20, 720, 1440) with np_save 28_January_00_2018 
2024-03-19 21:57:21,933 - root - WARNING - Initial condition 5 of 10 with corresponidng time  =  06_February_00_2018 and valid_year 2018
2024-03-19 21:57:22,620 - root - INFO - Begin autoregressive inference
2024-03-19 21:57:22,647 - root - WARNING -  >> MODEL_summary: ============================================================================================================================================
Layer (type (var_name))                  Input Shape               Output Shape              Param #                   Trainable
============================================================================================================================================
AFNONet (AFNONet)                        [1, 20, 720, 1440]        [1, 20, 720, 1440]        12,443,136                True
├─PatchEmbed (patch_embed)               [1, 20, 720, 1440]        [1, 16200, 768]           --                        True
│    └─Conv2d (proj)                     [1, 20, 720, 1440]        [1, 768, 90, 180]         983,808                   True
├─Dropout (pos_drop)                     [1, 16200, 768]           [1, 16200, 768]           --                        --
├─ModuleList (blocks)                    --                        --                        --                        True
│    └─Block (0)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (1)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (2)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (3)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (4)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (5)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (6)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (7)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (8)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (9)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (10)                        [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (11)                        [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
├─Linear (head)                          [1, 90, 180, 768]         [1, 90, 180, 1280]        983,040                   True
============================================================================================================================================
Total params: 74,691,840
Trainable params: 74,691,840
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 16.00
============================================================================================================================================
Input size (MB): 663.55
Forward/backward pass size (MB): 9820.57
Params size (MB): 248.99
Estimated Total Size (MB): 10733.12
============================================================================================================================================ 

2024-03-19 21:57:22,925 - root - INFO - Predicted timestep 0 of 8. z500 RMS Error: 0.0, ACC: 1.0
2024-03-19 21:57:23,077 - root - INFO - Predicted timestep 1 of 8. z500 RMS Error: 40.481136322021484, ACC: 0.9996451139450073
2024-03-19 21:57:23,230 - root - INFO - Predicted timestep 2 of 8. z500 RMS Error: 57.44785690307617, ACC: 0.9992781281471252
2024-03-19 21:57:23,383 - root - INFO - Predicted timestep 3 of 8. z500 RMS Error: 72.76214599609375, ACC: 0.9988397359848022
2024-03-19 21:57:23,535 - root - INFO - Predicted timestep 4 of 8. z500 RMS Error: 91.57139587402344, ACC: 0.9981630444526672
2024-03-19 21:57:23,688 - root - INFO - Predicted timestep 5 of 8. z500 RMS Error: 108.3152847290039, ACC: 0.997439980506897
2024-03-19 21:57:23,842 - root - INFO - Predicted timestep 6 of 8. z500 RMS Error: 128.69366455078125, ACC: 0.996364176273346
2024-03-19 21:57:23,994 - root - INFO - Predicted timestep 7 of 8. z500 RMS Error: 147.7533416748047, ACC: 0.9952389597892761
2024-03-19 21:57:24,185 - root - WARNING -  >>> saving predicted /scratch/gilbreth/gupt1075/ERA5_expts_march_19/afno_backbone/222/seq_pred_4_datetime_06_February_00_2018.npy 
2024-03-19 21:57:24,864 - root - WARNING -  >>> saving original /scratch/gilbreth/gupt1075/ERA5_expts_march_19/afno_backbone/222/seq_real_4_datetime_06_February_00_2018.npy 
2024-03-19 21:57:24,864 - root - WARNING -  saved real and predicted with shape (1, 8, 20, 720, 1440) (1, 8, 20, 720, 1440) with np_save 06_February_00_2018 
2024-03-19 21:57:24,864 - root - WARNING - Initial condition 6 of 10 with corresponidng time  =  15_February_00_2018 and valid_year 2018
2024-03-19 21:57:25,573 - root - INFO - Begin autoregressive inference
2024-03-19 21:57:25,600 - root - WARNING -  >> MODEL_summary: ============================================================================================================================================
Layer (type (var_name))                  Input Shape               Output Shape              Param #                   Trainable
============================================================================================================================================
AFNONet (AFNONet)                        [1, 20, 720, 1440]        [1, 20, 720, 1440]        12,443,136                True
├─PatchEmbed (patch_embed)               [1, 20, 720, 1440]        [1, 16200, 768]           --                        True
│    └─Conv2d (proj)                     [1, 20, 720, 1440]        [1, 768, 90, 180]         983,808                   True
├─Dropout (pos_drop)                     [1, 16200, 768]           [1, 16200, 768]           --                        --
├─ModuleList (blocks)                    --                        --                        --                        True
│    └─Block (0)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (1)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (2)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (3)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (4)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (5)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (6)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (7)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (8)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (9)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (10)                        [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (11)                        [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
├─Linear (head)                          [1, 90, 180, 768]         [1, 90, 180, 1280]        983,040                   True
============================================================================================================================================
Total params: 74,691,840
Trainable params: 74,691,840
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 16.00
============================================================================================================================================
Input size (MB): 663.55
Forward/backward pass size (MB): 9820.57
Params size (MB): 248.99
Estimated Total Size (MB): 10733.12
============================================================================================================================================ 

2024-03-19 21:57:25,878 - root - INFO - Predicted timestep 0 of 8. z500 RMS Error: 0.0, ACC: 1.0
2024-03-19 21:57:26,031 - root - INFO - Predicted timestep 1 of 8. z500 RMS Error: 39.718048095703125, ACC: 0.9996256232261658
2024-03-19 21:57:26,184 - root - INFO - Predicted timestep 2 of 8. z500 RMS Error: 57.09104919433594, ACC: 0.9992268085479736
2024-03-19 21:57:26,335 - root - INFO - Predicted timestep 3 of 8. z500 RMS Error: 70.63634490966797, ACC: 0.9987655878067017
2024-03-19 21:57:26,487 - root - INFO - Predicted timestep 4 of 8. z500 RMS Error: 87.80720520019531, ACC: 0.998060405254364
2024-03-19 21:57:26,640 - root - INFO - Predicted timestep 5 of 8. z500 RMS Error: 105.1732406616211, ACC: 0.9971781373023987
2024-03-19 21:57:26,793 - root - INFO - Predicted timestep 6 of 8. z500 RMS Error: 122.47148895263672, ACC: 0.996116578578949
2024-03-19 21:57:26,945 - root - INFO - Predicted timestep 7 of 8. z500 RMS Error: 136.8862762451172, ACC: 0.9951531291007996
2024-03-19 21:57:27,135 - root - WARNING -  >>> saving predicted /scratch/gilbreth/gupt1075/ERA5_expts_march_19/afno_backbone/222/seq_pred_5_datetime_15_February_00_2018.npy 
2024-03-19 21:57:27,735 - root - WARNING -  >>> saving original /scratch/gilbreth/gupt1075/ERA5_expts_march_19/afno_backbone/222/seq_real_5_datetime_15_February_00_2018.npy 
2024-03-19 21:57:27,735 - root - WARNING -  saved real and predicted with shape (1, 8, 20, 720, 1440) (1, 8, 20, 720, 1440) with np_save 15_February_00_2018 
2024-03-19 21:57:27,735 - root - WARNING - Initial condition 7 of 10 with corresponidng time  =  24_February_00_2018 and valid_year 2018
2024-03-19 21:57:28,427 - root - INFO - Begin autoregressive inference
2024-03-19 21:57:28,454 - root - WARNING -  >> MODEL_summary: ============================================================================================================================================
Layer (type (var_name))                  Input Shape               Output Shape              Param #                   Trainable
============================================================================================================================================
AFNONet (AFNONet)                        [1, 20, 720, 1440]        [1, 20, 720, 1440]        12,443,136                True
├─PatchEmbed (patch_embed)               [1, 20, 720, 1440]        [1, 16200, 768]           --                        True
│    └─Conv2d (proj)                     [1, 20, 720, 1440]        [1, 768, 90, 180]         983,808                   True
├─Dropout (pos_drop)                     [1, 16200, 768]           [1, 16200, 768]           --                        --
├─ModuleList (blocks)                    --                        --                        --                        True
│    └─Block (0)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (1)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (2)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (3)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (4)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (5)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (6)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (7)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (8)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (9)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (10)                        [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (11)                        [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
├─Linear (head)                          [1, 90, 180, 768]         [1, 90, 180, 1280]        983,040                   True
============================================================================================================================================
Total params: 74,691,840
Trainable params: 74,691,840
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 16.00
============================================================================================================================================
Input size (MB): 663.55
Forward/backward pass size (MB): 9820.57
Params size (MB): 248.99
Estimated Total Size (MB): 10733.12
============================================================================================================================================ 

2024-03-19 21:57:28,731 - root - INFO - Predicted timestep 0 of 8. z500 RMS Error: 0.0, ACC: 1.0
2024-03-19 21:57:28,885 - root - INFO - Predicted timestep 1 of 8. z500 RMS Error: 39.98298263549805, ACC: 0.9996182322502136
2024-03-19 21:57:29,037 - root - INFO - Predicted timestep 2 of 8. z500 RMS Error: 58.585636138916016, ACC: 0.999182403087616
2024-03-19 21:57:29,190 - root - INFO - Predicted timestep 3 of 8. z500 RMS Error: 70.41835021972656, ACC: 0.9988466501235962
2024-03-19 21:57:29,343 - root - INFO - Predicted timestep 4 of 8. z500 RMS Error: 87.94905090332031, ACC: 0.9981626868247986
2024-03-19 21:57:29,496 - root - INFO - Predicted timestep 5 of 8. z500 RMS Error: 108.07262420654297, ACC: 0.9971847534179688
2024-03-19 21:57:29,650 - root - INFO - Predicted timestep 6 of 8. z500 RMS Error: 133.9787139892578, ACC: 0.9956145882606506
2024-03-19 21:57:29,804 - root - INFO - Predicted timestep 7 of 8. z500 RMS Error: 160.52780151367188, ACC: 0.9937047958374023
2024-03-19 21:57:30,006 - root - WARNING -  >>> saving predicted /scratch/gilbreth/gupt1075/ERA5_expts_march_19/afno_backbone/222/seq_pred_6_datetime_24_February_00_2018.npy 
2024-03-19 21:57:30,780 - root - WARNING -  >>> saving original /scratch/gilbreth/gupt1075/ERA5_expts_march_19/afno_backbone/222/seq_real_6_datetime_24_February_00_2018.npy 
2024-03-19 21:57:30,780 - root - WARNING -  saved real and predicted with shape (1, 8, 20, 720, 1440) (1, 8, 20, 720, 1440) with np_save 24_February_00_2018 
2024-03-19 21:57:30,781 - root - WARNING - Initial condition 8 of 10 with corresponidng time  =  05_March_00_2018 and valid_year 2018
2024-03-19 21:57:31,469 - root - INFO - Begin autoregressive inference
2024-03-19 21:57:31,496 - root - WARNING -  >> MODEL_summary: ============================================================================================================================================
Layer (type (var_name))                  Input Shape               Output Shape              Param #                   Trainable
============================================================================================================================================
AFNONet (AFNONet)                        [1, 20, 720, 1440]        [1, 20, 720, 1440]        12,443,136                True
├─PatchEmbed (patch_embed)               [1, 20, 720, 1440]        [1, 16200, 768]           --                        True
│    └─Conv2d (proj)                     [1, 20, 720, 1440]        [1, 768, 90, 180]         983,808                   True
├─Dropout (pos_drop)                     [1, 16200, 768]           [1, 16200, 768]           --                        --
├─ModuleList (blocks)                    --                        --                        --                        True
│    └─Block (0)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (1)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (2)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (3)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (4)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (5)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (6)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (7)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (8)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (9)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (10)                        [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (11)                        [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
├─Linear (head)                          [1, 90, 180, 768]         [1, 90, 180, 1280]        983,040                   True
============================================================================================================================================
Total params: 74,691,840
Trainable params: 74,691,840
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 16.00
============================================================================================================================================
Input size (MB): 663.55
Forward/backward pass size (MB): 9820.57
Params size (MB): 248.99
Estimated Total Size (MB): 10733.12
============================================================================================================================================ 

2024-03-19 21:57:31,774 - root - INFO - Predicted timestep 0 of 8. z500 RMS Error: 0.0, ACC: 1.0
2024-03-19 21:57:31,927 - root - INFO - Predicted timestep 1 of 8. z500 RMS Error: 34.423553466796875, ACC: 0.999656617641449
2024-03-19 21:57:32,080 - root - INFO - Predicted timestep 2 of 8. z500 RMS Error: 49.0748405456543, ACC: 0.9993000626564026
2024-03-19 21:57:32,232 - root - INFO - Predicted timestep 3 of 8. z500 RMS Error: 57.91379165649414, ACC: 0.9989942312240601
2024-03-19 21:57:32,385 - root - INFO - Predicted timestep 4 of 8. z500 RMS Error: 78.26386260986328, ACC: 0.9981685280799866
2024-03-19 21:57:32,538 - root - INFO - Predicted timestep 5 of 8. z500 RMS Error: 89.12337493896484, ACC: 0.9976483583450317
2024-03-19 21:57:32,691 - root - INFO - Predicted timestep 6 of 8. z500 RMS Error: 108.42176055908203, ACC: 0.9964566826820374
2024-03-19 21:57:32,844 - root - INFO - Predicted timestep 7 of 8. z500 RMS Error: 122.80377960205078, ACC: 0.9954012036323547
2024-03-19 21:57:33,035 - root - WARNING -  >>> saving predicted /scratch/gilbreth/gupt1075/ERA5_expts_march_19/afno_backbone/222/seq_pred_7_datetime_05_March_00_2018.npy 
2024-03-19 21:57:33,670 - root - WARNING -  >>> saving original /scratch/gilbreth/gupt1075/ERA5_expts_march_19/afno_backbone/222/seq_real_7_datetime_05_March_00_2018.npy 
2024-03-19 21:57:33,670 - root - WARNING -  saved real and predicted with shape (1, 8, 20, 720, 1440) (1, 8, 20, 720, 1440) with np_save 05_March_00_2018 
2024-03-19 21:57:33,670 - root - WARNING - Initial condition 9 of 10 with corresponidng time  =  14_March_00_2018 and valid_year 2018
2024-03-19 21:57:34,349 - root - INFO - Begin autoregressive inference
2024-03-19 21:57:34,376 - root - WARNING -  >> MODEL_summary: ============================================================================================================================================
Layer (type (var_name))                  Input Shape               Output Shape              Param #                   Trainable
============================================================================================================================================
AFNONet (AFNONet)                        [1, 20, 720, 1440]        [1, 20, 720, 1440]        12,443,136                True
├─PatchEmbed (patch_embed)               [1, 20, 720, 1440]        [1, 16200, 768]           --                        True
│    └─Conv2d (proj)                     [1, 20, 720, 1440]        [1, 768, 90, 180]         983,808                   True
├─Dropout (pos_drop)                     [1, 16200, 768]           [1, 16200, 768]           --                        --
├─ModuleList (blocks)                    --                        --                        --                        True
│    └─Block (0)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (1)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (2)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (3)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (4)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (5)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (6)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (7)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (8)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (9)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (10)                        [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (11)                        [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
├─Linear (head)                          [1, 90, 180, 768]         [1, 90, 180, 1280]        983,040                   True
============================================================================================================================================
Total params: 74,691,840
Trainable params: 74,691,840
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 16.00
============================================================================================================================================
Input size (MB): 663.55
Forward/backward pass size (MB): 9820.57
Params size (MB): 248.99
Estimated Total Size (MB): 10733.12
============================================================================================================================================ 

2024-03-19 21:57:34,655 - root - INFO - Predicted timestep 0 of 8. z500 RMS Error: 0.0, ACC: 1.0
2024-03-19 21:57:34,808 - root - INFO - Predicted timestep 1 of 8. z500 RMS Error: 34.316184997558594, ACC: 0.9996668696403503
2024-03-19 21:57:34,961 - root - INFO - Predicted timestep 2 of 8. z500 RMS Error: 52.199031829833984, ACC: 0.9992451071739197
2024-03-19 21:57:35,114 - root - INFO - Predicted timestep 3 of 8. z500 RMS Error: 67.4875717163086, ACC: 0.9987603425979614
2024-03-19 21:57:35,266 - root - INFO - Predicted timestep 4 of 8. z500 RMS Error: 91.89934539794922, ACC: 0.9977535009384155
2024-03-19 21:57:35,419 - root - INFO - Predicted timestep 5 of 8. z500 RMS Error: 112.46349334716797, ACC: 0.9967042803764343
2024-03-19 21:57:35,573 - root - INFO - Predicted timestep 6 of 8. z500 RMS Error: 135.7175750732422, ACC: 0.9952130913734436
2024-03-19 21:57:35,726 - root - INFO - Predicted timestep 7 of 8. z500 RMS Error: 158.6426239013672, ACC: 0.9934440851211548
2024-03-19 21:57:35,923 - root - WARNING -  >>> saving predicted /scratch/gilbreth/gupt1075/ERA5_expts_march_19/afno_backbone/222/seq_pred_8_datetime_14_March_00_2018.npy 
2024-03-19 21:57:36,545 - root - WARNING -  >>> saving original /scratch/gilbreth/gupt1075/ERA5_expts_march_19/afno_backbone/222/seq_real_8_datetime_14_March_00_2018.npy 
2024-03-19 21:57:36,545 - root - WARNING -  saved real and predicted with shape (1, 8, 20, 720, 1440) (1, 8, 20, 720, 1440) with np_save 14_March_00_2018 
2024-03-19 21:57:36,545 - root - WARNING - Initial condition 10 of 10 with corresponidng time  =  23_March_00_2018 and valid_year 2018
2024-03-19 21:57:37,229 - root - INFO - Begin autoregressive inference
2024-03-19 21:57:37,256 - root - WARNING -  >> MODEL_summary: ============================================================================================================================================
Layer (type (var_name))                  Input Shape               Output Shape              Param #                   Trainable
============================================================================================================================================
AFNONet (AFNONet)                        [1, 20, 720, 1440]        [1, 20, 720, 1440]        12,443,136                True
├─PatchEmbed (patch_embed)               [1, 20, 720, 1440]        [1, 16200, 768]           --                        True
│    └─Conv2d (proj)                     [1, 20, 720, 1440]        [1, 768, 90, 180]         983,808                   True
├─Dropout (pos_drop)                     [1, 16200, 768]           [1, 16200, 768]           --                        --
├─ModuleList (blocks)                    --                        --                        --                        True
│    └─Block (0)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (1)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (2)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (3)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (4)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (5)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (6)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (7)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (8)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (9)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (10)                        [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (11)                        [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
├─Linear (head)                          [1, 90, 180, 768]         [1, 90, 180, 1280]        983,040                   True
============================================================================================================================================
Total params: 74,691,840
Trainable params: 74,691,840
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 16.00
============================================================================================================================================
Input size (MB): 663.55
Forward/backward pass size (MB): 9820.57
Params size (MB): 248.99
Estimated Total Size (MB): 10733.12
============================================================================================================================================ 

2024-03-19 21:57:37,535 - root - INFO - Predicted timestep 0 of 8. z500 RMS Error: 0.0, ACC: 1.0
2024-03-19 21:57:37,688 - root - INFO - Predicted timestep 1 of 8. z500 RMS Error: 36.96066665649414, ACC: 0.9996141195297241
2024-03-19 21:57:37,841 - root - INFO - Predicted timestep 2 of 8. z500 RMS Error: 53.25741195678711, ACC: 0.9991965293884277
2024-03-19 21:57:37,994 - root - INFO - Predicted timestep 3 of 8. z500 RMS Error: 67.00923919677734, ACC: 0.9987416863441467
2024-03-19 21:57:38,148 - root - INFO - Predicted timestep 4 of 8. z500 RMS Error: 87.139404296875, ACC: 0.9979001879692078
2024-03-19 21:57:38,302 - root - INFO - Predicted timestep 5 of 8. z500 RMS Error: 101.99374389648438, ACC: 0.9971166253089905
2024-03-19 21:57:38,455 - root - INFO - Predicted timestep 6 of 8. z500 RMS Error: 119.45429992675781, ACC: 0.9959083199501038
2024-03-19 21:57:38,608 - root - INFO - Predicted timestep 7 of 8. z500 RMS Error: 136.1692352294922, ACC: 0.994572103023529
2024-03-19 21:57:38,798 - root - WARNING -  >>> saving predicted /scratch/gilbreth/gupt1075/ERA5_expts_march_19/afno_backbone/222/seq_pred_9_datetime_23_March_00_2018.npy 
2024-03-19 21:57:39,483 - root - WARNING -  >>> saving original /scratch/gilbreth/gupt1075/ERA5_expts_march_19/afno_backbone/222/seq_real_9_datetime_23_March_00_2018.npy 
2024-03-19 21:57:39,484 - root - WARNING -  saved real and predicted with shape (1, 8, 20, 720, 1440) (1, 8, 20, 720, 1440) with np_save 23_March_00_2018 
2024-03-19 21:57:39,484 - root - INFO - Shapes: seq_real (1, 8, 20, 720, 1440), seq_pred (1, 8, 20, 720, 1440), valid_loss (10, 8, 20), valid_loss_coarse (10, 8, 20), acc (10, 8, 20), acc_coarse (10, 8, 20), acc_coarse_unweighted (10, 8, 20), acc_unweighted (10, 8, 20), acc_land (10, 8, 20), acc_sea (10, 8, 20)
2024-03-19 21:57:39,484 - root - INFO - Saving files at /scratch/gilbreth/gupt1075/ERA5_expts_march_19/afno_backbone/222/autoregressive_predictions_z500.h5
2024-03-19 21:57:39,484 - root - WARNING -  >>> ONLY_FLD (10, 8)  (10, 8) 
2024-03-19 22:01:42,375 - root - WARNING - ------------------ Configuration ------------------
2024-03-19 22:01:42,394 - root - WARNING -  Key: log_to_wandb : True 
2024-03-19 22:01:42,394 - root - WARNING -  Key: lr : 0.0005 
2024-03-19 22:01:42,394 - root - WARNING -  Key: batch_size : 64 
2024-03-19 22:01:42,394 - root - WARNING -  Key: max_epochs : 150 
2024-03-19 22:01:42,394 - root - WARNING -  Key: scheduler : CosineAnnealingLR 
2024-03-19 22:01:42,394 - root - WARNING -  Key: in_channels : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19] 
2024-03-19 22:01:42,394 - root - WARNING -  Key: out_channels : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19] 
2024-03-19 22:01:42,394 - root - WARNING -  Key: orography : False 
2024-03-19 22:01:42,394 - root - WARNING -  Key: orography_path : /scratch/gilbreth/wwtung/FourCastNet/data/static/orography.h5 
2024-03-19 22:01:42,394 - root - WARNING -  Key: exp_dir : /scratch/gilbreth/gupt1075/ERA5_expts_gtc/ 
2024-03-19 22:01:42,394 - root - WARNING -  Key: train_data_path : /scratch/gilbreth/wwtung/FourCastNet/data/train/ 
2024-03-19 22:01:42,394 - root - WARNING -  Key: valid_data_path : /scratch/gilbreth/wwtung/FourCastNet/data/test/ 
2024-03-19 22:01:42,394 - root - WARNING -  Key: inf_data_path : /scratch/gilbreth/wwtung/FourCastNet/data/out_of_sample 
2024-03-19 22:01:42,394 - root - WARNING -  Key: time_means_path : /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/time_means.npy 
2024-03-19 22:01:42,394 - root - WARNING -  Key: global_means_path : /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/global_means.npy 
2024-03-19 22:01:42,394 - root - WARNING -  Key: global_stds_path : /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/global_stds.npy 
2024-03-19 22:01:42,394 - root - WARNING -  Key: loss : l2 
2024-03-19 22:01:42,394 - root - WARNING -  Key: num_data_workers : 8 
2024-03-19 22:01:42,394 - root - WARNING -  Key: dt : 1 
2024-03-19 22:01:42,394 - root - WARNING -  Key: n_history : 0 
2024-03-19 22:01:42,394 - root - WARNING -  Key: prediction_type : iterative 
2024-03-19 22:01:42,394 - root - WARNING -  Key: prediction_length : 8 
2024-03-19 22:01:42,394 - root - WARNING -  Key: n_initial_conditions : 10 
2024-03-19 22:01:42,394 - root - WARNING -  Key: ics_type : default 
2024-03-19 22:01:42,394 - root - WARNING -  Key: save_raw_forecasts : True 
2024-03-19 22:01:42,394 - root - WARNING -  Key: save_channel : False 
2024-03-19 22:01:42,394 - root - WARNING -  Key: masked_acc : False 
2024-03-19 22:01:42,394 - root - WARNING -  Key: maskpath : None 
2024-03-19 22:01:42,394 - root - WARNING -  Key: perturb : False 
2024-03-19 22:01:42,395 - root - WARNING -  Key: add_grid : False 
2024-03-19 22:01:42,395 - root - WARNING -  Key: N_grid_channels : 0 
2024-03-19 22:01:42,395 - root - WARNING -  Key: gridtype : sinusoidal 
2024-03-19 22:01:42,395 - root - WARNING -  Key: roll : False 
2024-03-19 22:01:42,395 - root - WARNING -  Key: num_blocks : 8 
2024-03-19 22:01:42,395 - root - WARNING -  Key: nettype : afno 
2024-03-19 22:01:42,395 - root - WARNING -  Key: patch_size : 8 
2024-03-19 22:01:42,395 - root - WARNING -  Key: width : 56 
2024-03-19 22:01:42,395 - root - WARNING -  Key: modes : 32 
2024-03-19 22:01:42,395 - root - WARNING -  Key: target : default 
2024-03-19 22:01:42,395 - root - WARNING -  Key: normalization : zscore 
2024-03-19 22:01:42,395 - root - WARNING -  Key: log_to_screen : True 
2024-03-19 22:01:42,395 - root - WARNING -  Key: save_checkpoint : True 
2024-03-19 22:01:42,395 - root - WARNING -  Key: enable_nhwc : False 
2024-03-19 22:01:42,395 - root - WARNING -  Key: optimizer_type : Adam 
2024-03-19 22:01:42,395 - root - WARNING -  Key: crop_size_x : None 
2024-03-19 22:01:42,395 - root - WARNING -  Key: crop_size_y : None 
2024-03-19 22:01:42,395 - root - WARNING -  Key: two_step_training : False 
2024-03-19 22:01:42,395 - root - WARNING -  Key: plot_animations : False 
2024-03-19 22:01:42,395 - root - WARNING -  Key: add_noise : False 
2024-03-19 22:01:42,395 - root - WARNING -  Key: noise_std : 0 
2024-03-19 22:01:42,395 - root - WARNING - ---------------------------------------------------
2024-03-19 22:01:42,558 - root - INFO - --------------- Versions ---------------
2024-03-19 22:01:42,558 - root - INFO - Torch: 2.0.1
2024-03-19 22:01:42,558 - root - INFO - ----------------------------------------
2024-03-19 22:01:42,558 - root - INFO - ------------------ Configuration ------------------
2024-03-19 22:01:42,558 - root - INFO - Configuration file: /scratch/gilbreth/gupt1075/FourCastNet_gil/config/AFNO.yaml
2024-03-19 22:01:42,558 - root - INFO - Configuration name: afno_backbone
2024-03-19 22:01:42,558 - root - INFO - log_to_wandb True
2024-03-19 22:01:42,558 - root - INFO - lr 0.0005
2024-03-19 22:01:42,558 - root - INFO - batch_size 64
2024-03-19 22:01:42,558 - root - INFO - max_epochs 150
2024-03-19 22:01:42,558 - root - INFO - scheduler CosineAnnealingLR
2024-03-19 22:01:42,558 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2024-03-19 22:01:42,558 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2024-03-19 22:01:42,559 - root - INFO - orography False
2024-03-19 22:01:42,559 - root - INFO - orography_path /scratch/gilbreth/wwtung/FourCastNet/data/static/orography.h5
2024-03-19 22:01:42,559 - root - INFO - exp_dir /scratch/gilbreth/gupt1075/ERA5_expts_gtc/
2024-03-19 22:01:42,559 - root - INFO - train_data_path /scratch/gilbreth/wwtung/FourCastNet/data/train/
2024-03-19 22:01:42,559 - root - INFO - valid_data_path /scratch/gilbreth/wwtung/FourCastNet/data/test/
2024-03-19 22:01:42,559 - root - INFO - inf_data_path /scratch/gilbreth/wwtung/FourCastNet/data/out_of_sample
2024-03-19 22:01:42,559 - root - INFO - time_means_path /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/time_means.npy
2024-03-19 22:01:42,559 - root - INFO - global_means_path /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/global_means.npy
2024-03-19 22:01:42,559 - root - INFO - global_stds_path /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/global_stds.npy
2024-03-19 22:01:42,559 - root - INFO - loss l2
2024-03-19 22:01:42,559 - root - INFO - num_data_workers 8
2024-03-19 22:01:42,559 - root - INFO - dt 1
2024-03-19 22:01:42,559 - root - INFO - n_history 0
2024-03-19 22:01:42,559 - root - INFO - prediction_type iterative
2024-03-19 22:01:42,559 - root - INFO - prediction_length 8
2024-03-19 22:01:42,559 - root - INFO - n_initial_conditions 10
2024-03-19 22:01:42,559 - root - INFO - ics_type default
2024-03-19 22:01:42,559 - root - INFO - save_raw_forecasts True
2024-03-19 22:01:42,559 - root - INFO - save_channel False
2024-03-19 22:01:42,559 - root - INFO - masked_acc False
2024-03-19 22:01:42,559 - root - INFO - maskpath None
2024-03-19 22:01:42,559 - root - INFO - perturb False
2024-03-19 22:01:42,559 - root - INFO - add_grid False
2024-03-19 22:01:42,559 - root - INFO - N_grid_channels 0
2024-03-19 22:01:42,559 - root - INFO - gridtype sinusoidal
2024-03-19 22:01:42,559 - root - INFO - roll False
2024-03-19 22:01:42,559 - root - INFO - num_blocks 8
2024-03-19 22:01:42,559 - root - INFO - nettype afno
2024-03-19 22:01:42,559 - root - INFO - patch_size 8
2024-03-19 22:01:42,559 - root - INFO - width 56
2024-03-19 22:01:42,559 - root - INFO - modes 32
2024-03-19 22:01:42,559 - root - INFO - target default
2024-03-19 22:01:42,560 - root - INFO - normalization zscore
2024-03-19 22:01:42,560 - root - INFO - log_to_screen True
2024-03-19 22:01:42,560 - root - INFO - save_checkpoint True
2024-03-19 22:01:42,560 - root - INFO - enable_nhwc False
2024-03-19 22:01:42,560 - root - INFO - optimizer_type Adam
2024-03-19 22:01:42,560 - root - INFO - crop_size_x None
2024-03-19 22:01:42,560 - root - INFO - crop_size_y None
2024-03-19 22:01:42,560 - root - INFO - two_step_training False
2024-03-19 22:01:42,560 - root - INFO - plot_animations False
2024-03-19 22:01:42,560 - root - INFO - add_noise False
2024-03-19 22:01:42,560 - root - INFO - noise_std 0
2024-03-19 22:01:42,560 - root - INFO - fld z500
2024-03-19 22:01:42,560 - root - INFO - world_size 1
2024-03-19 22:01:42,560 - root - INFO - interp 0
2024-03-19 22:01:42,560 - root - INFO - use_daily_climatology False
2024-03-19 22:01:42,560 - root - INFO - global_batch_size 64
2024-03-19 22:01:42,560 - root - INFO - idxes {'u10': 0, 'z500': 14, '2m_temperature': 2, 'v10': 1, 't850': 5}
2024-03-19 22:01:42,560 - root - INFO - DECORRELATION_TIME 36
2024-03-19 22:01:42,560 - root - INFO - experiment_dir /scratch/gilbreth/gupt1075/ERA5_expts_march_19/afno_backbone/222
2024-03-19 22:01:42,560 - root - INFO - best_checkpoint_path /scratch/gilbreth/wwtung/FourCastNet/model_weights/FCN_weights_v0/backbone.ckpt
2024-03-19 22:01:42,560 - root - INFO - resuming False
2024-03-19 22:01:42,560 - root - INFO - local_rank 0
2024-03-19 22:01:42,560 - root - INFO - ---------------------------------------------------
2024-03-19 22:01:42,561 - root - WARNING -  
 ICS for default: [  0  36  72 108 144 180 216 252 288 324] num_samples 1328  prediction_lnegth: 8   
2024-03-19 22:01:42,562 - root - WARNING - Getting file stats from /scratch/gilbreth/wwtung/FourCastNet/data/out_of_sample/2018.h5
2024-03-19 22:01:42,563 - root - WARNING -  n_years: 1  
 n_samples_per_yeaer: 1460 
 dt: 1  n_history: 0 
2024-03-19 22:01:42,563 - root - WARNING - Number of samples per year: 1460
2024-03-19 22:01:42,563 - root - WARNING - Found data at path /scratch/gilbreth/wwtung/FourCastNet/data/out_of_sample. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2024-03-19 22:01:42,563 - root - WARNING - Delta t: 6 hours
2024-03-19 22:01:42,563 - root - WARNING - Including 0 hours of past history in training at a frequency of 6 hours
2024-03-19 22:01:42,563 - root - INFO - Loading trained model checkpoint from /scratch/gilbreth/wwtung/FourCastNet/model_weights/FCN_weights_v0/backbone.ckpt
2024-03-19 22:01:42,565 - root - INFO -  in_channels  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19] 20   >>   out_channels [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19] 20  params.global_means_path /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/global_means.npy params.global_stds_path /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/global_stds.npy  
2024-03-19 22:01:45,183 - root - INFO -  in_channels 20   out_channels 20  params.global_means_path /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/global_means.npy params.global_stds_path /scratch/gilbreth/wwtung/FourCastNet/additional/stats_v0/global_stds.npy  
2024-03-19 22:01:45,183 - root - INFO -  Loading validation data from ['/scratch/gilbreth/wwtung/FourCastNet/data/out_of_sample/2018.h5']
2024-03-19 22:01:45,184 - root - WARNING -  valid_year 2018   
2024-03-19 22:01:45,184 - root - WARNING - Initial condition 1 of 10 with corresponidng time  =  01_January_00_2018 and valid_year 2018
2024-03-19 22:01:45,865 - root - INFO - Begin autoregressive inference
2024-03-19 22:01:46,434 - root - WARNING -  >> MODEL_summary: ============================================================================================================================================
Layer (type (var_name))                  Input Shape               Output Shape              Param #                   Trainable
============================================================================================================================================
AFNONet (AFNONet)                        [1, 20, 720, 1440]        [1, 20, 720, 1440]        12,443,136                True
├─PatchEmbed (patch_embed)               [1, 20, 720, 1440]        [1, 16200, 768]           --                        True
│    └─Conv2d (proj)                     [1, 20, 720, 1440]        [1, 768, 90, 180]         983,808                   True
├─Dropout (pos_drop)                     [1, 16200, 768]           [1, 16200, 768]           --                        --
├─ModuleList (blocks)                    --                        --                        --                        True
│    └─Block (0)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (1)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (2)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (3)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (4)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (5)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (6)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (7)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (8)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (9)                         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (10)                        [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    └─Block (11)                        [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    └─LayerNorm (norm1)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─AFNO2D (filter)              [1, 90, 180, 768]         [1, 90, 180, 768]         297,984                   True
│    │    └─LayerNorm (norm2)            [1, 90, 180, 768]         [1, 90, 180, 768]         1,536                     True
│    │    └─Mlp (mlp)                    [1, 90, 180, 768]         [1, 90, 180, 768]         --                        True
│    │    │    └─Linear (fc1)            [1, 90, 180, 768]         [1, 90, 180, 3072]        2,362,368                 True
│    │    │    └─GELU (act)              [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Dropout (drop)          [1, 90, 180, 3072]        [1, 90, 180, 3072]        --                        --
│    │    │    └─Linear (fc2)            [1, 90, 180, 3072]        [1, 90, 180, 768]         2,360,064                 True
│    │    │    └─Dropout (drop)          [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
│    │    └─Identity (drop_path)         [1, 90, 180, 768]         [1, 90, 180, 768]         --                        --
├─Linear (head)                          [1, 90, 180, 768]         [1, 90, 180, 1280]        983,040                   True
============================================================================================================================================
Total params: 74,691,840
Trainable params: 74,691,840
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 16.00
============================================================================================================================================
Input size (MB): 663.55
Forward/backward pass size (MB): 9820.57
Params size (MB): 248.99
Estimated Total Size (MB): 10733.12
============================================================================================================================================ 

2024-03-19 22:01:46,713 - root - INFO - Predicted timestep 0 of 8. z500 RMS Error: 0.0, ACC: 1.0
2024-03-19 22:01:47,948 - root - INFO - Predicted timestep 1 of 8. z500 RMS Error: 34.425804138183594, ACC: 0.9996493458747864
2024-03-19 22:01:48,100 - root - INFO - Predicted timestep 2 of 8. z500 RMS Error: 48.357078552246094, ACC: 0.9993206262588501
2024-03-19 22:01:48,253 - root - INFO - Predicted timestep 3 of 8. z500 RMS Error: 63.70835494995117, ACC: 0.9988381862640381
2024-03-19 22:01:48,407 - root - INFO - Predicted timestep 4 of 8. z500 RMS Error: 81.07498931884766, ACC: 0.9981367588043213
2024-03-19 22:01:48,561 - root - INFO - Predicted timestep 5 of 8. z500 RMS Error: 92.77654266357422, ACC: 0.9976038336753845
2024-03-19 22:01:48,715 - root - INFO - Predicted timestep 6 of 8. z500 RMS Error: 109.06070709228516, ACC: 0.9967321753501892
2024-03-19 22:01:48,867 - root - INFO - Predicted timestep 7 of 8. z500 RMS Error: 122.5030288696289, ACC: 0.9959385395050049
2024-03-19 22:01:49,041 - root - WARNING -  >>> saving predicted /scratch/gilbreth/gupt1075/ERA5_expts_march_19/afno_backbone/222/seq_pred_0_datetime_01_January_00_2018.npy 
2024-03-19 22:01:49,663 - root - WARNING -  >>> saving original /scratch/gilbreth/gupt1075/ERA5_expts_march_19/afno_backbone/222/seq_real_0_datetime_01_January_00_2018.npy 
2024-03-19 22:01:49,664 - root - WARNING -  saved real and predicted with shape (1, 8, 20, 720, 1440) (1, 8, 20, 720, 1440) with np_save 01_January_00_2018 
